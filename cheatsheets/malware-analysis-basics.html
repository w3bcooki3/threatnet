<h1>Malware Analysis: Beginner's Guide</h1>
<div class="cheatsheet-detail-meta-info">
    <span><i class="fas fa-user-circle"></i> ThreatNet Team</span>
    <span><i class="fas fa-calendar-alt"></i> July 23, 2025</span>
    <span><i class="fas fa-tag"></i> Malware, Analysis, Forensics</span>
</div>
<p>Malware analysis is the process of studying malicious software to understand its behavior, functionality, and potential impact. It's essential for incident response, threat intelligence, and developing countermeasures.</p>

<h2>Types of Malware Analysis</h2>
<h3>1. Static Analysis</h3>
<p>Examining the malware executable without running it. This can reveal metadata, packed code, libraries, and functions.</p>
<ul>
    <li><b>String Extraction:</b> Look for readable text strings (URLs, file paths, API calls, error messages).</li>
    <li><b>File Hashing:</b> Calculate cryptographic hashes (MD5, SHA1, SHA256) to identify known malware.</li>
    <li><b>Packed/Obfuscated Code Detection:</b> Identify if the malware is compressed or obfuscated.</li>
    <li><b>PE Header Analysis:</b> Examine Portable Executable (PE) file headers for compile time, sections, imports, and exports.</li>
    <li><b>Disassembly:</b> Using a disassembler to convert machine code into assembly language.</li>
</ul>
<pre><code>Tools:
    - strings (Linux/Windows Sysinternals)
    - hashdeep, certutil
    - PEStudio, ExifTool
    - IDA Pro (Disassembler)
    - Ghidra (Disassembler/Decompiler)</code></pre>

<h3>2. Dynamic Analysis (Behavioral Analysis)</h3>
<p>Executing the malware in a controlled, isolated environment (sandbox) to observe its behavior.</p>
<ul>
    <li><b>Process Monitoring:</b> Observe spawned processes, injected processes, and process trees.</li>
    <li><b>File System Changes:</b> Monitor file creation, modification, deletion, and file access.</li>
    <li><b>Registry Changes:</b> Track registry key creation, modification, and deletion.</li>
    <li><b>Network Activity:</b> Monitor DNS requests, HTTP/HTTPS traffic, C2 communications, and data exfiltration attempts.</li>
    <li><b>Memory Dumps:</b> Capture memory snapshots for further analysis.</li>
</ul>
<pre><code>Tools:
    - Cuckoo Sandbox (automated dynamic analysis)
    - Procmon (Process Monitor - Windows Sysinternals)
    - Wireshark (network packet analyzer)
    - FakeDNS, INetSim (for network simulation)
    - Regshot (registry comparison)</code></pre>

<h2>Setting up a Safe Environment</h2>
<p>Always perform malware analysis in an isolated environment to prevent infection of your host system or network.</p>
<ul>
    <li><b>Virtual Machines:</b> Use VMs (e.g., VMware, VirtualBox) with host-only networking.</li>
    <li><b>Snapshots:</b> Take snapshots of your VM before running malware, and revert after each analysis.</li>
    <li><b>Internet Isolation:</b> Use tools like FakeDNS or INetSim to simulate internet services without actual internet access.</li>
    <li><b>Dedicated Hardware (for advanced cases):</b> For highly evasive or destructive malware.</li>
</ul>

<h2>Important Considerations</h2>
<ul>
    <li><b>Anti-Analysis Techniques:</b> Malware often employs techniques to detect and evade analysis environments.</li>
    <li><b>Legal and Ethical Implications:</b> Handling malware carries risks. Ensure you comply with all relevant laws and organizational policies.</li>
    <li><b>Documentation:</b> Thoroughly document all observed behaviors, indicators of compromise (IOCs), and analysis findings.</li>
</ul>