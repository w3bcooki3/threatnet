<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberSec Unveiled: Advanced Security Knowledge Base</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Global Reset & Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-bg: #0d1117; /* Darker Space Grey */
            --secondary-bg: #161b22; /* Slightly Lighter Space Grey */
            --accent-bg: #21262d; /* Even Lighter Space Grey for cards/sections */
            --primary-text: #e6edf3; /* Off-white for readability */
            --secondary-text: #8b949e; /* Grey for less emphasis */
            --accent-color: #58a6ff; /* Vibrant Blue for highlights/links */
            --success-color: #3fb950; /* Green for success/info */
            --warning-color: #e3b341; /* Yellow for warnings */
            --danger-color: #ff7b72; /* Red for critical warnings */
            --border-color: #30363d; /* Subtle border */
            --hover-bg: #2d333b; /* Hover state for interactive elements */
            --code-bg: #010409; /* Very dark background for code */
            --code-text: #c9d1d9; /* Lighter text for code */
            --syntax-string: #a5d6ff; /* Light blue for strings */
            --syntax-keyword: #79c0ff; /* Blue for keywords */
            --syntax-comment: #8b949e; /* Grey for comments */
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(145deg, var(--primary-bg), var(--secondary-bg));
            color: var(--primary-text);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-y: scroll; /* Allow body scrolling */
        }

        a {
            color: var(--accent-color);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        a:hover {
            color: var(--success-color);
            text-decoration: underline;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            width: 100%; /* Ensure container takes full width on small screens */
        }

        /* Header */
        .header {
            background: rgba(13, 17, 23, 0.95); /* Darker, slightly transparent */
            backdrop-filter: blur(8px);
            border-bottom: 2px solid var(--accent-color);
            padding: 1rem 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1.5rem; /* Space between elements */
        }

        .logo {
            font-family: 'Roboto Mono', monospace;
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--success-color); /* Green for 'unveiled' effect */
            text-shadow: 0 0 12px rgba(63, 185, 80, 0.5); /* Glowing green effect */
            white-space: nowrap; /* Prevent wrapping */
        }

        /* Search */
        .search-container {
            position: relative;
            flex-grow: 1;
            max-width: 500px; /* Slightly wider search bar */
        }

        .search-input {
            width: 100%;
            padding: 0.8rem 1rem;
            background: var(--accent-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--primary-text);
            font-size: 1rem;
            transition: all 0.3s ease;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .search-input::placeholder {
            color: var(--secondary-text);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.3);
            background: var(--hover-bg); /* Darker on focus */
        }

        /* Main Content Layout */
        .main-content {
            display: flex;
            margin-top: 100px; /* Space for fixed header */
            gap: 2rem;
            padding-top: 2rem; /* Padding for the top of the main content */
            flex: 1; /* Allow main content to grow */
        }

        /* Sidebar */
        .sidebar {
            width: 300px;
            background: var(--secondary-bg);
            border-radius: 12px;
            padding: 1.5rem;
            height: fit-content;
            position: sticky; /* Sticky sidebar */
            top: 120px; /* Offset from fixed header */
            border: 1px solid var(--border-color);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .sidebar h3 {
            color: var(--accent-color);
            margin-bottom: 1.2rem;
            font-size: 1.3rem;
            border-bottom: 1px dashed var(--border-color);
            padding-bottom: 0.8rem;
        }

        .category-list {
            list-style: none;
        }

        .category-item {
            padding: 0.9rem 1.2rem;
            margin-bottom: 0.6rem;
            background: var(--accent-bg);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
            font-size: 1rem;
            font-weight: 600;
            color: var(--primary-text);
        }

        .category-item:hover {
            background: var(--hover-bg);
            border-left-color: var(--accent-color);
            transform: translateX(5px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .category-item.active {
            background: var(--hover-bg);
            border-left-color: var(--success-color); /* Active item is green */
            color: var(--success-color);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        /* Content Area */
        .content-area {
            flex: 1;
            background: var(--secondary-bg);
            border-radius: 12px;
            padding: 2.5rem;
            border: 1px solid var(--border-color);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            min-height: 600px; /* Minimum height for content area */
        }

        .topic-header {
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 1.2rem;
            margin-bottom: 2.5rem;
        }

        .topic-header h2 {
            color: var(--success-color);
            font-size: 2.5rem;
            margin-bottom: 0.8rem;
            font-weight: 700;
        }

        .topic-description {
            color: var(--secondary-text);
            font-size: 1.15rem;
        }

        .section {
            margin-bottom: 3rem;
            padding: 2rem;
            background: var(--accent-bg);
            border-radius: 10px;
            border-left: 5px solid var(--accent-color);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .section h3 {
            color: var(--accent-color);
            margin-bottom: 1.2rem;
            font-size: 1.8rem;
            border-bottom: 1px dotted var(--border-color);
            padding-bottom: 0.5rem;
        }

        .section h4 {
            color: var(--primary-text);
            margin: 1.5rem 0 0.8rem 0;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .section p {
            margin-bottom: 1rem;
            color: var(--secondary-text);
            font-size: 1.05rem;
        }

        .section ul {
            list-style-type: disc;
            margin-left: 25px;
            margin-bottom: 1rem;
        }

        .section li {
            margin-bottom: 0.5rem;
            color: var(--secondary-text);
        }

        /* Code Blocks */
        .code-block {
            background: var(--code-bg);
            padding: 1.2rem 1.5rem;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-family: 'Roboto Mono', monospace;
            margin: 1.5rem 0;
            position: relative;
            overflow-x: auto;
            font-size: 0.95rem;
            color: var(--code-text);
            white-space: pre-wrap; /* Preserve whitespace and wrap */
            word-break: break-word; /* Break long words */
        }

        .code-block::before {
            content: attr(data-lang);
            position: absolute;
            top: 0.8rem;
            right: 1.2rem;
            background: var(--accent-color);
            color: var(--primary-bg);
            padding: 0.2rem 0.6rem;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .code-block code {
            display: block; /* Ensure code block takes full width */
            padding-right: 60px; /* Space for the language tag */
        }

        .code-block .copy-button {
            position: absolute;
            bottom: 0.8rem;
            right: 1.2rem;
            background: var(--accent-color);
            color: var(--primary-bg);
            border: none;
            padding: 0.4rem 0.8rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
            opacity: 0.8;
        }

        .code-block .copy-button:hover {
            background-color: var(--success-color);
            transform: translateY(-2px);
            opacity: 1;
        }

        /* Syntax Highlighting - Simplified for CSS */
        .code-block .kql-keyword, .code-block .python-keyword, .code-block .bash-keyword, .code-block .sql-keyword, .code-block .yaml-keyword, .code-block .powershell-keyword {
            color: var(--syntax-keyword);
            font-weight: bold;
        }

        .code-block .kql-string, .code-block .python-string, .code-block .bash-string, .code-block .sql-string, .code-block .yaml-string, .code-block .powershell-string {
            color: var(--syntax-string);
        }

        .code-block .kql-comment, .code-block .python-comment, .code-block .bash-comment, .code-block .sql-comment, .code-block .yaml-comment, .code-block .powershell-comment {
            color: var(--syntax-comment);
            font-style: italic;
        }

        .highlight {
            background: rgba(88, 166, 255, 0.2); /* Light blue background for highlights */
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            color: var(--accent-color);
            font-weight: 600;
        }

        /* Info/Warning Boxes */
        .warning-box, .info-box {
            padding: 1.2rem 1.5rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            font-size: 1rem;
            line-height: 1.5;
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .warning-box {
            background: rgba(255, 123, 114, 0.1); /* Light red background */
            border: 1px solid var(--danger-color);
            color: var(--danger-color);
        }

        .warning-box::before {
            content: "‚ö†Ô∏è";
            font-size: 1.5rem;
            line-height: 1;
            color: var(--danger-color);
        }

        .info-box {
            background: rgba(63, 185, 80, 0.1); /* Light green background */
            border: 1px solid var(--success-color);
            color: var(--success-color);
        }

        .info-box::before {
            content: "üí°";
            font-size: 1.5rem;
            line-height: 1;
            color: var(--success-color);
        }
        .info-box strong, .warning-box strong {
            color: var(--primary-text); /* Make titles inside boxes white for contrast */
            font-weight: 700;
        }

        /* Tools Grid */
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); /* Slightly wider cards */
            gap: 1.5rem; /* More space between cards */
            margin: 1.5rem 0;
        }

        .tool-card {
            background: var(--primary-bg); /* Darker background for cards */
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            justify-content: space-between; /* Push tags to bottom */
        }

        .tool-card:hover {
            border-color: var(--accent-color);
            transform: translateY(-5px); /* More pronounced hover effect */
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .tool-name {
            color: var(--success-color); /* Green for tool names */
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 0.7rem;
        }

        .tool-card p {
            color: var(--secondary-text);
            font-size: 0.95rem;
            margin-bottom: 1rem;
        }

        .tag-container {
            margin-top: auto; /* Push tags to the bottom */
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .tag {
            display: inline-block;
            background: var(--accent-color);
            color: var(--primary-bg);
            padding: 0.3rem 0.7rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }
        .tag.commercial { background-color: var(--danger-color); }
        .tag.freemium { background-color: var(--warning-color); }
        .tag.open-source { background-color: var(--success-color); }
        .tag.api { background-color: #8b5cf6; } /* Purple for API */
        .tag.real-time { background-color: #ec4899; } /* Pink for real-time */
        .tag.proactive { background-color: #22d3ee; } /* Cyan for proactive */
        .tag.surgical { background-color: #f97316; } /* Orange for surgical */


        /* Mobile Menu Toggle */
        .mobile-menu-toggle {
            display: none; /* Hidden by default */
            background: none;
            border: none;
            color: var(--accent-color);
            font-size: 2rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }

        .mobile-menu-toggle:hover {
            background-color: var(--hover-bg);
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .loading {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 300px;
            color: var(--accent-color);
            font-size: 1.2rem;
            text-align: center;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid var(--border-color);
            border-top: 5px solid var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Breadcrumb */
        .breadcrumb {
            background: var(--accent-bg);
            padding: 0.7rem 1.2rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
            color: var(--secondary-text);
            border: 1px solid var(--border-color);
        }

        .breadcrumb a {
            color: var(--accent-color);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }
        .breadcrumb span {
            color: var(--primary-text);
            font-weight: 600;
        }

        /* No results message */
        .no-results {
            text-align: center;
            padding: 50px;
            color: var(--secondary-text);
            font-size: 1.2rem;
        }

        /* Footer */
        .footer {
            margin-top: auto; /* Push footer to the bottom */
            background: var(--primary-bg);
            color: var(--secondary-text);
            text-align: center;
            padding: 1.5rem 0;
            border-top: 1px solid var(--border-color);
            font-size: 0.9rem;
        }
        .footer p {
            margin: 0;
        }

        /* Responsive Adjustments */
        @media (max-width: 992px) {
            .main-content {
                flex-direction: column;
                margin-top: 80px; /* Adjust for smaller header */
                padding-top: 1.5rem;
            }

            .sidebar {
                width: 100%;
                position: static; /* No longer sticky on small screens */
                order: 2; /* Move sidebar below content on small screens */
                padding: 1rem;
            }

            .content-area {
                padding: 1.5rem;
                order: 1; /* Content above sidebar on small screens */
            }

            .mobile-menu-toggle {
                display: block; /* Show toggle button */
            }

            .search-container {
                flex-grow: 1; /* Allow search to take more space */
                max-width: none;
                margin: 0;
                display: block; /* Ensure it's block to break line if needed */
            }

            .header-content {
                flex-wrap: wrap; /* Allow wrapping */
                justify-content: center; /* Center items when wrapped */
                padding: 0 10px;
            }

            .logo {
                font-size: 1.5rem;
                flex-basis: 100%; /* Take full width on small screens */
                text-align: center;
                margin-bottom: 1rem;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 0 15px;
            }
            .header {
                padding: 0.8rem 0;
            }
            .logo {
                font-size: 1.3rem;
            }
            .search-input {
                padding: 0.7rem 0.8rem;
                font-size: 0.95rem;
            }
            .sidebar {
                padding: 1rem;
            }
            .category-item {
                font-size: 0.9rem;
                padding: 0.7rem 1rem;
            }
            .content-area {
                padding: 1rem;
            }
            .topic-header h2 {
                font-size: 2rem;
            }
            .topic-description {
                font-size: 1rem;
            }
            .section {
                padding: 1.2rem;
            }
            .section h3 {
                font-size: 1.5rem;
            }
            .section h4 {
                font-size: 1.15rem;
            }
            .code-block {
                font-size: 0.85rem;
                padding: 1rem 1.2rem;
            }
            .code-block::before {
                font-size: 0.7rem;
                padding: 0.15rem 0.4rem;
            }
            .code-block .copy-button {
                font-size: 0.75rem;
                padding: 0.3rem 0.6rem;
            }
            .tool-card {
                padding: 1rem;
            }
            .tool-name {
                font-size: 1.1rem;
            }
            .tag {
                font-size: 0.75rem;
                padding: 0.2rem 0.6rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">CyberSec Unveiled</div>
                <div class="search-container">
                    <input type="text" class="search-input" placeholder="Search techniques, tools, procedures..." id="searchInput" aria-label="Search encyclopedia">
                </div>
                <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle navigation menu">‚ò∞</button>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="main-content">
            <aside class="sidebar" id="sidebar" role="navigation" aria-label="Main Categories">
                <h3>Categories</h3>
                <ul class="category-list" id="categoryList">
                    <li class="category-item active" data-category="soc" tabindex="0" role="button">SOC Operations</li>
                    <li class="category-item" data-category="osint" tabindex="0" role="button">OSINT Techniques</li>
                    <li class="category-item" data-category="threat-hunting" tabindex="0" role="button">Threat Hunting</li>
                    <li class="category-item" data-category="dfir" tabindex="0" role="button">DFIR</li>
                    <li class="category-item" data-category="malware-analysis" tabindex="0" role="button">Malware Analysis</li>
                    <li class="category-item" data-category="network-security" tabindex="0" role="button">Network Security</li>
                    <li class="category-item" data-category="cloud-security" tabindex="0" role="button">Cloud Security</li>
                    <li class="category-item" data-category="red-team" tabindex="0" role="button">Red Team TTPs</li>
                    <li class="category-item" data-category="blue-team" tabindex="0" role="button">Blue Team Defense</li>
                    <li class="category-item" data-category="frameworks" tabindex="0" role="button">Frameworks & Standards</li>
                </ul>
            </aside>

            <div class="content-area" role="main">
                <div class="breadcrumb" id="breadcrumb" aria-label="Breadcrumb navigation">
                    <a href="#" onclick="showCategory('home'); return false;">Home</a> &gt; <span id="currentCategory">SOC Operations</span>
                </div>
                <div id="content" class="fade-in">
                    </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 CyberSec Unveiled. All rights reserved. Built with passion by a cybersecurity enthusiast.</p>
        </div>
    </footer>

    <script>
        // Content Database - Using a more structured approach for easier management
        // Each entry has a title, description, and sections.
        // Sections contain title, raw HTML content, and a 'tools' array if applicable.
        // Code blocks are distinguished by 'data-lang' for potential future syntax highlighting.

        const contentData = {
            'soc': {
                title: 'SOC Operations',
                description: 'Advanced Security Operations Center procedures, playbooks, and methodologies for tier 2+ analysts.',
                sections: [
                    {
                        title: 'Advanced Alert Triage',
                        content: `
                            <h4>Multi-Vector Analysis Framework</h4>
                            <p>Implement a systematic approach to alert correlation across multiple data sources:</p>
                            <div class="code-block" data-lang="KQL">
                                <code class="language-kql">
<span class="kql-comment">// Advanced KQL for cross-correlation</span>
SecurityAlert
<span class="kql-keyword">| where</span> TimeGenerated > ago(1h)
<span class="kql-keyword">| extend</span> ThreatIndicators = parse_json(ExtendedProperties)
<span class="kql-keyword">| join</span> <span class="kql-keyword">kind</span>=inner (
    SecurityEvent
    <span class="kql-keyword">| where</span> EventID <span class="kql-keyword">in</span> (4624, 4625, 4648)
    <span class="kql-keyword">| where</span> TimeGenerated > ago(1h)
) <span class="kql-keyword">on</span> $left.CompromisedEntity == $right.Account
<span class="kql-keyword">| summarize</span> AlertCount = count(), 
           EventTypes = make_set(EventID),
           FirstSeen = min(TimeGenerated),
           LastSeen = max(TimeGenerated)
  <span class="kql-keyword">by</span> CompromisedEntity, AlertName
<span class="kql-keyword">| where</span> AlertCount > 3
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            
                            <h4>Contextual Enrichment Pipeline</h4>
                            <p>Automated enrichment strategies for high-fidelity alerts:</p>
                            <ul>
                                <li><strong>Asset Context:</strong> CMDB integration, criticality scoring, network segmentation</li>
                                <li><strong>Threat Intelligence:</strong> IOC reputation, campaign attribution, TTPs mapping</li>
                                <li><strong>User Context:</strong> Privilege escalation history, anomalous behavior patterns</li>
                                <li><strong>Environmental Context:</strong> Maintenance windows, change requests, business context</li>
                            </ul>
                            
                            <div class="info-box">
                                <strong>Pro Tip:</strong> Use threat hunting queries as validation mechanisms for automated triage decisions.
                            </div>
                        `
                    },
                    {
                        title: 'Incident Response Orchestration',
                        content: `
                            <h4>SOAR Playbook Architecture</h4>
                            <p>Design scalable playbooks for complex incident scenarios:</p>
                            
                            <div class="code-block" data-lang="Python">
                                <code class="language-python">
<span class="python-comment"># Advanced SOAR logic for multi-stage incidents</span>
<span class="python-keyword">def</span> orchestrate_incident_response(alert):
    severity = calculate_dynamic_severity(alert)
    
    <span class="python-keyword">if</span> severity >= 8:
        parallel_execute([
            isolate_endpoint(alert.source_ip),
            collect_memory_dump(alert.hostname),
            initiate_threat_hunt(alert.indicators),
            notify_stakeholders(severity_level=<span class="python-string">"CRITICAL"</span>)
        ])
    
    <span class="python-comment"># Adaptive response based on TTPs</span>
    mitre_tactics = extract_mitre_tactics(alert)
    <span class="python-keyword">if</span> <span class="python-string">"lateral_movement"</span> <span class="python-keyword">in</span> mitre_tactics:
        execute_lateral_movement_playbook(alert)
    
    <span class="python-keyword">return</span> orchestration_results
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            
                            <h4>Advanced Containment Strategies</h4>
                        `,
                        tools: [
                            { name: 'Network Microsegmentation', description: 'Dynamic VLAN assignment and SDN-based isolation', tags: ['Real-time', 'Proactive'] },
                            { name: 'DNS Sinkholing', description: 'Automated malicious domain redirection', tags: ['Proactive', 'Automated'] },
                            { name: 'Endpoint Quarantine', description: 'Selective process termination and file quarantine', tags: ['Surgical', 'Real-time'] }
                        ]
                    },
                    {
                        title: 'Advanced Analytics & Detection',
                        content: `
                            <h4>Behavioral Analytics Implementation</h4>
                            <p>Machine learning models for anomaly detection:</p>
                            
                            <div class="code-block" data-lang="SQL">
                                <code class="language-sql">
<span class="sql-comment">-- Advanced user behavior analytics</span>
<span class="sql-keyword">WITH</span> UserBaseline <span class="sql-keyword">AS</span> (
    <span class="sql-keyword">SELECT</span> 
        UserId,
        AVG(LoginCount) <span class="sql-keyword">as</span> AvgLogins,
        STDDEV(LoginCount) <span class="sql-keyword">as</span> StdDevLogins,
        AVG(DataTransferred) <span class="sql-keyword">as</span> AvgDataTransfer,
        PERCENTILE_CONT(0.95) <span class="sql-keyword">WITHIN GROUP</span> (ORDER <span class="sql-keyword">BY</span> LoginHours) <span class="sql-keyword">as</span> P95LoginHours
    <span class="sql-keyword">FROM</span> UserActivity
    <span class="sql-keyword">WHERE</span> Date >= DATEADD(day, -30, GETDATE())
    <span class="sql-keyword">GROUP BY</span> UserId
),
CurrentBehavior <span class="sql-keyword">AS</span> (
    <span class="sql-keyword">SELECT</span> 
        UserId,
        COUNT(*) <span class="sql-keyword">as</span> TodayLogins,
        SUM(DataTransferred) <span class="sql-keyword">as</span> TodayDataTransfer,
        MAX(DATEPART(hour, LoginTime)) <span class="sql-keyword">as</span> MaxLoginHour
    <span class="sql-keyword">FROM</span> UserActivity
    <span class="sql-keyword">WHERE</span> Date = CAST(GETDATE() <span class="sql-keyword">AS</span> DATE)
    <span class="sql-keyword">GROUP BY</span> UserId
)
<span class="sql-keyword">SELECT</span> 
    cb.UserId,
    <span class="sql-keyword">CASE</span> 
        <span class="sql-keyword">WHEN</span> cb.TodayLogins > ub.AvgLogins + (3 * ub.StdDevLogins) <span class="sql-keyword">THEN</span> <span class="sql-string">'ANOMALOUS_LOGIN_FREQUENCY'</span>
        <span class="sql-keyword">WHEN</span> cb.TodayDataTransfer > ub.AvgDataTransfer * 10 <span class="sql-keyword">THEN</span> <span class="sql-string">'ANOMALOUS_DATA_TRANSFER'</span>
        <span class="sql-keyword">WHEN</span> cb.MaxLoginHour > ub.P95LoginHours <span class="sql-keyword">THEN</span> <span class="sql-string">'ANOMALOUS_LOGIN_TIME'</span>
        <span class="sql-keyword">ELSE</span> <span class="sql-string">'NORMAL'</span>
    <span class="sql-keyword">END</span> <span class="sql-keyword">as</span> AnomalyType,
    (cb.TodayLogins - ub.AvgLogins) / <span class="sql-keyword">NULLIF</span>(ub.StdDevLogins, 0) <span class="sql-keyword">as</span> LoginZScore
<span class="sql-keyword">FROM</span> CurrentBehavior cb
<span class="sql-keyword">JOIN</span> UserBaseline ub <span class="sql-keyword">ON</span> cb.UserId = ub.UserId
<span class="sql-keyword">WHERE</span> AnomalyType != <span class="sql-string">'NORMAL'</span>
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            
                            <h4>Custom Detection Rules</h4>
                            <p>Advanced Sigma rules for sophisticated threats:</p>
                            
                            <div class="code-block" data-lang="YAML">
                                <code class="language-yaml">
<span class="yaml-keyword">title</span>: Advanced Lateral Movement Detection
<span class="yaml-keyword">id</span>: 12345678-1234-1234-1234-123456789012
<span class="yaml-keyword">description</span>: Detects sophisticated lateral movement patterns
<span class="yaml-keyword">author</span>: SOC Team
<span class="yaml-keyword">date</span>: 2024/01/01
<span class="yaml-keyword">references</span>:
    - https://attack.mitre.org/techniques/T1021/
<span class="yaml-keyword">logsource</span>:
    <span class="yaml-keyword">category</span>: process_creation
    <span class="yaml-keyword">product</span>: windows
<span class="yaml-keyword">detection</span>:
    <span class="yaml-keyword">selection_psexec</span>:
        <span class="yaml-keyword">Image|endswith</span>: <span class="yaml-string">'\\psexec.exe'</span>
        <span class="yaml-keyword">CommandLine|contains</span>: 
            - <span class="yaml-string">'-accepteula'</span>
            - <span class="yaml-string">'-s'</span>
    <span class="yaml-keyword">selection_wmi</span>:
        <span class="yaml-keyword">Image|endswith</span>: <span class="yaml-string">'\\wmic.exe'</span>
        <span class="yaml-keyword">CommandLine|contains</span>: <span class="yaml-string">'process call create'</span>
    <span class="yaml-keyword">selection_powershell</span>:
        <span class="yaml-keyword">Image|endswith</span>: <span class="yaml-string">'\\powershell.exe'</span>
        <span class="yaml-keyword">CommandLine|contains</span>:
            - <span class="yaml-string">'Invoke-Command'</span>
            - <span class="yaml-string">'New-PSSession'</span>
    <span class="yaml-keyword">timeframe</span>: 5m
    <span class="yaml-keyword">condition</span>: (selection_psexec or selection_wmi or selection_powershell) | count() > 3
<span class="yaml-keyword">falsepositives</span>:
    - Legitimate administrative activities
<span class="yaml-keyword">level</span>: high
<span class="yaml-keyword">tags</span>:
    - attack.lateral_movement
    - attack.t1021
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                        `
                    }
                ]
            },
            'osint': {
                title: 'OSINT Techniques',
                description: 'Advanced Open Source Intelligence gathering methodologies and tools for threat intelligence.',
                sections: [
                    {
                        title: 'Advanced Domain & Infrastructure Analysis',
                        content: `
                            <h4>Passive DNS Hunting</h4>
                            <p>Comprehensive infrastructure mapping using passive DNS data:</p>
                            
                            <div class="code-block" data-lang="Python">
                                <code class="language-python">
<span class="python-keyword">import</span> requests
<span class="python-keyword">import</span> json
<span class="python-keyword">from</span> datetime <span class="python-keyword">import</span> datetime, timedelta

<span class="python-keyword">class</span> PassiveDNSHunter:
    <span class="python-keyword">def</span> __init__(self):
        <span class="python-keyword">self</span>.sources = {
            <span class="python-string">'virustotal'</span>: <span class="python-string">'https://www.virustotal.com/vtapi/v2/domain/report'</span>,
            <span class="python-string">'passivetotal'</span>: <span class="python-string">'https://api.passivetotal.org/v2/dns/passive'</span>,
            <span class="python-string">'threatcrowd'</span>: <span class="python-string">'https://www.threatcrowd.org/searchApi/v2/domain/report/'</span>
        }
    
    <span class="python-keyword">def</span> hunt_infrastructure(self, domain, days_back=90):
        results = {}
        
        <span class="python-comment"># Passive DNS resolution history</span>
        passive_dns = <span class="python-keyword">self</span>.get_passive_dns(domain, days_back)
        
        <span class="python-comment"># Certificate transparency logs</span>
        cert_data = <span class="python-keyword">self</span>.get_cert_transparency(domain)
        
        <span class="python-comment"># WHOIS historical data</span>
        whois_history = <span class="python-keyword">self</span>.get_whois_history(domain)
        
        <span class="python-comment"># Subdomain enumeration via certificate logs</span>
        subdomains = <span class="python-keyword">self</span>.enumerate_subdomains_ct(domain)
        
        <span class="python-keyword">return</span> {
            <span class="python-string">'passive_dns'</span>: passive_dns,
            <span class="python-string">'certificates'</span>: cert_data,
            <span class="python-string">'whois_history'</span>: whois_history,
            <span class="python-string">'subdomains'</span>: subdomains,
            <span class="python-string">'infrastructure_score'</span>: <span class="python-keyword">self</span>.calculate_infrastructure_risk(results)
        }
    
    <span class="python-keyword">def</span> pivoting_analysis(self, initial_ioc):
        <span class="python-string">"""Advanced pivoting through infrastructure relationships"""</span>
        pivot_chain = []
        
        <span class="python-comment"># ASN-based pivoting</span>
        asn_data = <span class="python-keyword">self</span>.get_asn_info(initial_ioc)
        related_ips = <span class="python-keyword">self</span>.get_asn_neighbors(asn_data[<span class="python-string">'asn'</span>])
        
        <span class="python-comment"># SSL certificate pivoting</span>
        cert_sha1 = <span class="python-keyword">self</span>.get_ssl_cert_hash(initial_ioc)
        cert_related_domains = <span class="python-keyword">self</span>.find_domains_by_cert(cert_sha1)
        
        <span class="python-comment"># Registrar pivoting</span>
        registrar_info = <span class="python-keyword">self</span>.get_registrar_info(initial_ioc)
        registrar_domains = <span class="python-keyword">self</span>.find_domains_by_registrar(registrar_info)
        
        <span class="python-keyword">return</span> pivot_chain
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            
                            <h4>Advanced WHOIS Analysis</h4>
                        `,
                        tools: [
                            { name: 'DomainTools Iris', description: 'Historical WHOIS data and domain profiling', tags: ['Commercial'] },
                            { name: 'PassiveTotal', description: 'Comprehensive passive DNS and WHOIS', tags: ['Freemium'] },
                            { name: 'Shodan', description: 'Internet-connected device discovery', tags: ['API'] }
                        ]
                    },
                    {
                        title: 'Social Engineering Intelligence',
                        content: `
                            <h4>Advanced Social Media Analysis</h4>
                            <p>Comprehensive social media intelligence gathering:</p>
                            
                            <div class="code-block" data-lang="Python">
                                <code class="language-python">
<span class="python-keyword">class</span> SocialMediaIntelligence:
    <span class="python-keyword">def</span> __init__(self):
        <span class="python-keyword">self</span>.platforms = [<span class="python-string">'linkedin'</span>, <span class="python-string">'twitter'</span>, <span class="python-string">'facebook'</span>, <span class="python-string">'instagram'</span>, <span class="python-string">'github'</span>]
        <span class="python-keyword">self</span>.osint_tools = {
            <span class="python-string">'sherlock'</span>: <span class="python-keyword">self</span>.username_enumeration,
            <span class="python-string">'social_mapper'</span>: <span class="python-keyword">self</span>.facial_recognition_search,
            <span class="python-string">'twint'</span>: <span class="python-keyword">self</span>.twitter_deep_analysis,
            <span class="python-string">'linkedin_scraper'</span>: <span class="python-keyword">self</span>.linkedin_employee_enum
        }
    
    <span class="python-keyword">def</span> comprehensive_person_analysis(self, target_name, company=<span class="python-keyword">None</span>):
        profile = {
            <span class="python-string">'personal_info'</span>: {},
            <span class="python-string">'professional_info'</span>: {},
            <span class="python-string">'social_connections'</span>: {},
            <span class="python-string">'digital_footprint'</span>: {},
            <span class="python-string">'potential_vectors'</span>: []
        }
        
        <span class="python-comment"># LinkedIn enumeration for corporate targets</span>
        <span class="python-keyword">if</span> company:
            employees = <span class="python-keyword">self</span>.enumerate_company_employees(company)
            target_profile = <span class="python-keyword">self</span>.find_target_in_employees(target_name, employees)
        
        <span class="python-comment"># Cross-platform username correlation</span>
        usernames = <span class="python-keyword">self</span>.correlate_usernames(target_name)
        
        <span class="python-comment"># Email pattern analysis</span>
        email_patterns = <span class="python-keyword">self</span>.analyze_email_patterns(company)
        probable_emails = <span class="python-keyword">self</span>.generate_probable_emails(target_name, email_patterns)
        
        <span class="python-comment"># Phone number OSINT</span>
        phone_data = <span class="python-keyword">self</span>.phone_number_osint(target_profile.get(<span class="python-string">'phone'</span>))
        
        <span class="python-comment"># Document metadata analysis</span>
        documents = <span class="python-keyword">self</span>.search_document_metadata(target_name, company)
        
        <span class="python-keyword">return</span> <span class="python-keyword">self</span>.compile_intelligence_report(profile)
    
    <span class="python-keyword">def</span> identify_attack_vectors(self, target_profile):
        <span class="python-string">"""Identify potential social engineering vectors"""</span>
        vectors = []
        
        <span class="python-comment"># Personal interests for pretexting</span>
        interests = <span class="python-keyword">self</span>.extract_interests(target_profile[<span class="python-string">'social_posts'</span>])
        
        <span class="python-comment"># Professional connections for trust building</span>
        connections = <span class="python-keyword">self</span>.map_professional_network(target_profile[<span class="python-string">'linkedin'</span>])
        
        <span class="python-comment"># Technology usage patterns</span>
        tech_stack = <span class="python-keyword">self</span>.identify_technology_usage(target_profile)
        
        <span class="python-keyword">return</span> vectors
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            
                            <div class="warning-box">
                                <strong>Legal Notice:</strong> All OSINT activities must comply with local laws, platform terms of service, and ethical guidelines. Never use this information for harassment or illegal activities.
                            </div>
                        `
                    },
                    {
                        title: 'Threat Intelligence Correlation',
                        content: `
                            <h4>Multi-Source Intelligence Fusion</h4>
                            <p>Automated correlation across multiple threat intelligence feeds:</p>
                            
                            <div class="code-block" data-lang="Python">
                                <code class="language-python">
<span class="python-keyword">class</span> ThreatIntelligenceCorrelator:
    <span class="python-keyword">def</span> __init__(self):
        <span class="python-keyword">self</span>.ti_feeds = {
            <span class="python-string">'commercial'</span>: [<span class="python-string">'CrowdStrike'</span>, <span class="python-string">'FireEye'</span>, <span class="python-string">'Recorded Future'</span>],
            <span class="python-string">'open_source'</span>: [<span class="python-string">'AlienVault OTX'</span>, <span class="python-string">'MISP'</span>, <span class="python-string">'ThreatFox'</span>],
            <span class="python-string">'government'</span>: [<span class="python-string">'US-CERT'</span>, <span class="python-string">'NCSC'</span>, <span class="python-string">'CISA'</span>],
            <span class="python-string">'community'</span>: [<span class="python-string">'Malware Bazaar'</span>, <span class="python-string">'URLhaus'</span>, <span class="python-string">'Hybrid Analysis'</span>]
        }
    
    <span class="python-keyword">def</span> correlate_indicators(self, ioc_list):
        correlation_matrix = {}
        
        <span class="python-keyword">for</span> ioc <span class="python-keyword">in</span> ioc_list:
            ioc_intelligence = {
                <span class="python-string">'reputation_scores'</span>: <span class="python-keyword">self</span>.get_reputation_scores(ioc),
                <span class="python-string">'campaign_attribution'</span>: <span class="python-keyword">self</span>.get_campaign_attribution(ioc),
                <span class="python-string">'ttps_mapping'</span>: <span class="python-keyword">self</span>.map_to_mitre_attack(ioc),
                <span class="python-string">'temporal_analysis'</span>: <span class="python-keyword">self</span>.analyze_temporal_patterns(ioc),
                <span class="python-string">'geolocation_data'</span>: <span class="python-keyword">self</span>.get_geolocation_intelligence(ioc)
            }
            
            <span class="python-comment"># Advanced correlation algorithms</span>
            similarity_scores = <span class="python-keyword">self</span>.calculate_ioc_similarity(ioc, ioc_list)
            campaign_clusters = <span class="python-keyword">self</span>.cluster_by_campaign(ioc_intelligence)
            
            correlation_matrix[ioc] = {
                <span class="python-string">'intelligence'</span>: ioc_intelligence,
                <span class="python-string">'correlations'</span>: similarity_scores,
                <span class="python-string">'clusters'</span>: campaign_clusters
            }
        
        <span class="python-keyword">return</span> <span class="python-keyword">self</span>.generate_intelligence_report(correlation_matrix)
    
    <span class="python-keyword">def</span> predictive_threat_modeling(self, historical_data):
        <span class="python-string">"""Use ML to predict future threat activities"""</span>
        model = <span class="python-keyword">self</span>.train_threat_prediction_model(historical_data)
        
        <span class="python-comment"># Predict likely targets</span>
        target_predictions = model.predict_targets()
        
        <span class="python-comment"># Predict attack timelines</span>
        temporal_predictions = model.predict_timing()
        
        <span class="python-comment"># Predict TTPs evolution</span>
        ttps_evolution = model.predict_ttps_evolution()
        
        <span class="python-keyword">return</span> {
            <span class="python-string">'predictions'</span>: target_predictions,
            <span class="python-string">'timeline'</span>: temporal_predictions,
            <span class="python-string">'ttps_evolution'</span>: ttps_evolution,
            <span class="python-string">'confidence_scores'</span>: model.confidence_metrics
        }
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            
                            <h4>Automated IOC Enrichment</h4>
                            <div class="info-box">
                                <strong>Best Practice:</strong> Implement automated IOC enrichment pipelines that continuously update threat intelligence databases with contextual information, attribution data, and relationship mappings.
                            </div>
                        `
                    }
                ]
            },
            'threat-hunting': {
                title: 'Threat Hunting',
                description: 'Advanced threat hunting methodologies, hypothesis development, and proactive detection techniques.',
                sections: [
                    {
                        title: 'Hypothesis-Driven Hunting',
                        content: `
                            <h4>Advanced Hypothesis Framework</h4>
                            <p>Structured approach to developing and testing threat hunting hypotheses:</p>
                            
                            <div class="code-block" data-lang="Python">
                                <code class="language-python">
<span class="python-keyword">class</span> ThreatHuntingFramework:
    <span class="python-keyword">def</span> __init__(self):
        <span class="python-keyword">self</span>.hypothesis_categories = {
            <span class="python-string">'behavioral'</span>: <span class="python-string">'User/Entity behavior anomalies'</span>,
            <span class="python-string">'temporal'</span>: <span class="python-string">'Time-based attack patterns'</span>,
            <span class="python-string">'network'</span>: <span class="python-string">'Network communication anomalies'</span>,
            <span class="python-string">'endpoint'</span>: <span class="python-string">'Host-based artifacts'</span>,
            <span class="python-string">'intelligence'</span>: <span class="python-string">'TI-driven hypotheses'</span>
        }
    
    <span class="python-keyword">def</span> develop_hypothesis(self, threat_landscape, asset_inventory):
        <span class="python-string">"""Develop data-driven hunting hypotheses"""</span>
        hypotheses = []
        
        <span class="python-comment"># Intelligence-driven hypotheses</span>
        current_campaigns = <span class="python-keyword">self</span>.get_active_campaigns()
        <span class="python-keyword">for</span> campaign <span class="python-keyword">in</span> current_campaigns:
            <span class="python-keyword">if</span> <span class="python-keyword">self</span>.assess_campaign_relevance(campaign, asset_inventory):
                hypothesis = <span class="python-keyword">self</span>.create_campaign_hypothesis(campaign)
                hypotheses.append(hypothesis)
        
        <span class="python-comment"># Behavioral hypotheses</span>
        behavioral_patterns = <span class="python-keyword">self</span>.analyze_baseline_behavior()
        anomaly_hypotheses = <span class="python-keyword">self</span>.generate_anomaly_hypotheses(behavioral_patterns)
        
        <span class="python-comment"># Crown jewel protection hypotheses</span>
        crown_jewels = <span class="python-keyword">self</span>.identify_crown_jewels(asset_inventory)
        protection_hypotheses = <span class="python-keyword">self</span>.generate_protection_hypotheses(crown_jewels)
        
        <span class="python-keyword">return</span> <span class="python-keyword">self</span>.prioritize_hypotheses(hypotheses + anomaly_hypotheses + protection_hypotheses)
    
    <span class="python-keyword">def</span> execute_hunt(self, hypothesis):
        <span class="python-string">"""Execute hunting operations based on hypothesis"""</span>
        hunt_plan = {
            <span class="python-string">'data_sources'</span>: <span class="python-keyword">self</span>.identify_required_data_sources(hypothesis),
            <span class="python-string">'queries'</span>: <span class="python-keyword">self</span>.generate_hunting_queries(hypothesis),
            <span class="python-string">'analytics'</span>: <span class="python-keyword">self</span>.select_analytics_techniques(hypothesis),
            <span class="python-string">'timeline'</span>: <span class="python-keyword">self</span>.create_hunting_timeline(hypothesis)
        }
        
        <span class="python-comment"># Execute queries across data sources</span>
        results = <span class="python-keyword">self</span>.execute_hunting_queries(hunt_plan[<span class="python-string">'queries'</span>])
        
        <span class="python-comment"># Apply advanced analytics</span>
        analyzed_results = <span class="python-keyword">self</span>.apply_advanced_analytics(results, hunt_plan[<span class="python-string">'analytics'</span>])
        
        <span class="python-comment"># Validate findings</span>
        validated_findings = <span class="python-keyword">self</span>.validate_findings(analyzed_results)
        
        <span class="python-keyword">return</span> <span class="python-keyword">self</span>.generate_hunt_report(hypothesis, validated_findings)
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            
                            <h4>Advanced Hunting Queries</h4>
                            <p>Complex KQL queries for sophisticated threat detection:</p>
                            
                            <div class="code-block" data-lang="KQL">
                                <code class="language-kql">
<span class="kql-comment">// Advanced lateral movement detection</span>
<span class="kql-keyword">let</span> timeRange = 1h;
<span class="kql-keyword">let</span> suspiciousProcesses = dynamic([<span class="kql-string">"psexec.exe"</span>, <span class="kql-string">"wmic.exe"</span>, <span class="kql-string">"powershell.exe"</span>, <span class="kql-string">"cmd.exe"</span>]);
<span class="kql-keyword">let</span> adminUsers = SecurityEvent 
    <span class="kql-keyword">| where</span> TimeGenerated > ago(timeRange)
    <span class="kql-keyword">| where</span> EventID == 4672
    <span class="kql-keyword">| distinct</span> Account;
<span class="kql-comment">// Hunt for potential lateral movement</span>
SecurityEvent
<span class="kql-keyword">| where</span> TimeGenerated > ago(timeRange)
<span class="kql-keyword">| where</span> EventID == 4688
<span class="kql-keyword">| where</span> Process <span class="kql-keyword">has_any</span> (suspiciousProcesses)
<span class="kql-keyword">| where</span> Account <span class="kql-keyword">in</span> (adminUsers)
<span class="kql-keyword">| extend</span> ProcessHash = hash_sha256(strcat(Computer, Process, CommandLine))
<span class="kql-keyword">| join</span> <span class="kql-keyword">kind</span>=inner (
    SecurityEvent
    <span class="kql-keyword">| where</span> TimeGenerated > ago(timeRange)
    <span class="kql-keyword">| where</span> EventID == 4624
    <span class="kql-keyword">| where</span> LogonType <span class="kql-keyword">in</span> (3, 10)
    <span class="kql-keyword">| extend</span> LoginHash = hash_sha256(strcat(Computer, Account, SourceNetworkAddress))
) <span class="kql-keyword">on</span> Computer, Account
<span class="kql-keyword">| where</span> datetime_diff(<span class="kql-string">'minute'</span>, TimeGenerated, TimeGenerated1) <span class="kql-keyword">between</span> (0 .. 30)
<span class="kql-keyword">| summarize</span> ProcessCount = dcount(ProcessHash),
           ComputerCount = dcount(Computer),
           FirstActivity = min(TimeGenerated),
           LastActivity = max(TimeGenerated),
           Processes = make_set(Process),
           Computers = make_set(Computer)
  <span class="kql-keyword">by</span> Account
<span class="kql-keyword">| where</span> ProcessCount > 3 <span class="kql-keyword">and</span> ComputerCount > 2
<span class="kql-keyword">| extend</span> ThreatScore = (ProcessCount * 2) + (ComputerCount * 3)
<span class="kql-keyword">| order by</span> ThreatScore <span class="kql-keyword">desc</span>
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                        `
                    },
                    {
                        title: 'Advanced Behavioral Analytics',
                        content: `
                            <h4>Machine Learning for Threat Detection</h4>
                            <p>Implementing ML models for advanced behavioral analysis:</p>
                            
                            <div class="code-block" data-lang="Python">
                                <code class="language-python">
<span class="python-keyword">import</span> pandas <span class="python-keyword">as</span> pd
<span class="python-keyword">import</span> numpy <span class="python-keyword">as</span> np
<span class="python-keyword">from</span> sklearn.ensemble <span class="python-keyword">import</span> IsolationForest
<span class="python-keyword">from</span> sklearn.preprocessing <span class="python-keyword">import</span> StandardScaler
<span class="python-keyword">from</span> sklearn.cluster <span class="python-keyword">import</span> DBSCAN

<span class="python-keyword">class</span> BehavioralAnalytics:
    <span class="python-keyword">def</span> __init__(self):
        <span class="python-keyword">self</span>.models = {
            <span class="python-string">'isolation_forest'</span>: IsolationForest(contamination=0.1, random_state=42),
            <span class="python-string">'dbscan'</span>: DBSCAN(eps=0.5, min_samples=5),
            <span class="python-string">'user_behavior'</span>: <span class="python-keyword">self</span>.create_user_behavior_model(),
            <span class="python-string">'network_behavior'</span>: <span class="python-keyword">self</span>.create_network_behavior_model()
        }
    
    <span class="python-keyword">def</span> analyze_user_behavior(self, user_data):
        <span class="python-string">"""Advanced user behavior analysis"""</span>
        <span class="python-comment"># Feature engineering</span>
        features = <span class="python-keyword">self</span>.extract_behavioral_features(user_data)
        
        <span class="python-comment"># Time-series analysis</span>
        temporal_patterns = <span class="python-keyword">self</span>.analyze_temporal_patterns(user_data)
        
        <span class="python-comment"># Anomaly detection</span>
        anomalies = <span class="python-keyword">self</span>.detect_behavioral_anomalies(features)
        
        <span class="python-comment"># Risk scoring</span>
        risk_scores = <span class="python-keyword">self</span>.calculate_behavioral_risk_scores(features, anomalies)
        
        <span class="python-keyword">return</span> {
            <span class="python-string">'anomalies'</span>: anomalies,
            <span class="python-string">'risk_scores'</span>: risk_scores,
            <span class="python-string">'temporal_patterns'</span>: temporal_patterns,
            <span class="python-string">'behavioral_changes'</span>: <span class="python-keyword">self</span>.detect_behavioral_changes(features)
        }
    
    <span class="python-keyword">def</span> hunt_for_insider_threats(self, employee_data):
        <span class="python-string">"""Specialized hunting for insider threats"""</span>
        insider_indicators = {
            <span class="python-string">'data_exfiltration'</span>: <span class="python-keyword">self</span>.detect_data_exfiltration_patterns(employee_data),
            <span class="python-string">'privilege_abuse'</span>: <span class="python-keyword">self</span>.detect_privilege_abuse(employee_data),
            <span class="python-string">'suspicious_access'</span>: <span class="python-keyword">self</span>.detect_suspicious_access_patterns(employee_data),
            <span class="python-string">'emotional_indicators'</span>: <span class="python-keyword">self</span>.analyze_emotional_indicators(employee_data)
        }
        
        <span class="python-comment"># Combine indicators using weighted scoring</span>
        insider_risk_score = <span class="python-keyword">self</span>.calculate_insider_risk_score(insider_indicators)
        
        <span class="python-keyword">return</span> {
            <span class="python-string">'risk_score'</span>: insider_risk_score,
            <span class="python-string">'indicators'</span>: insider_indicators,
            <span class="python-string">'recommendations'</span>: <span class="python-keyword">self</span>.generate_insider_threat_recommendations(insider_indicators)
        }
    
    <span class="python-keyword">def</span> advanced_network_hunting(self, network_data):
        <span class="python-string">"""Advanced network-based threat hunting"""</span>
        <span class="python-comment"># DNS analysis</span>
        dns_anomalies = <span class="python-keyword">self</span>.detect_dns_anomalies(network_data[<span class="python-string">'dns'</span>])
        
        <span class="python-comment"># Traffic flow analysis</span>
        flow_anomalies = <span class="python-keyword">self</span>.detect_traffic_flow_anomalies(network_data[<span class="python-string">'flows'</span>])
        
        <span class="python-comment"># Communication pattern analysis</span>
        comm_patterns = <span class="python-keyword">self</span>.analyze_communication_patterns(network_data)
        
        <span class="python-comment"># Beaconing detection</span>
        beaconing_analysis = <span class="python-keyword">self</span>.detect_beaconing_behavior(network_data)
        
        <span class="python-keyword">return</span> {
            <span class="python-string">'dns_anomalies'</span>: dns_anomalies,
            <span class="python-string">'flow_anomalies'</span>: flow_anomalies,
            <span class="python-string">'communication_patterns'</span>: comm_patterns,
            <span class="python-string">'beaconing'</span>: beaconing_analysis
        }
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            
                            <h4>Advanced DNS Analysis</h4>
                            <div class="code-block" data-lang="SQL">
                                <code class="language-sql">
<span class="sql-comment">-- Hunt for DNS tunneling and exfiltration</span>
<span class="sql-keyword">WITH</span> DNSStats <span class="sql-keyword">AS</span> (
    <span class="sql-keyword">SELECT</span> 
        ClientIP,
        QueryName,
        QueryType,
        ResponseCode,
        COUNT(*) <span class="sql-keyword">as</span> QueryCount,
        AVG(LEN(QueryName)) <span class="sql-keyword">as</span> AvgQueryLength,
        STDEV(LEN(QueryName)) <span class="sql-keyword">as</span> StdevQueryLength,
        COUNT(DISTINCT QueryName) <span class="sql-keyword">as</span> UniqueQueries,
        MIN(Timestamp) <span class="sql-keyword">as</span> FirstSeen,
        MAX(Timestamp) <span class="sql-keyword">as</span> LastSeen
    <span class="sql-keyword">FROM</span> DNSLogs
    <span class="sql-keyword">WHERE</span> Timestamp >= DATEADD(hour, -24, GETUTCDATE())
    <span class="sql-keyword">GROUP BY</span> ClientIP, QueryName, QueryType, ResponseCode
),
SuspiciousDNS <span class="sql-keyword">AS</span> (
    <span class="sql-keyword">SELECT</span> 
        ClientIP,
        QueryName,
        QueryCount,
        AvgQueryLength,
        UniqueQueries,
        <span class="sql-keyword">CASE</span> 
            <span class="sql-keyword">WHEN</span> AvgQueryLength > 50 <span class="sql-keyword">THEN</span> <span class="sql-string">'LONG_QUERIES'</span>
            <span class="sql-keyword">WHEN</span> QueryCount > 1000 <span class="sql-keyword">THEN</span> <span class="sql-string">'HIGH_FREQUENCY'</span>
            <span class="sql-keyword">WHEN</span> UniqueQueries > 500 <span class="sql-keyword">THEN</span> <span class="sql-string">'HIGH_DIVERSITY'</span>
            <span class="sql-keyword">WHEN</span> QueryName LIKE <span class="sql-string">'%.%'</span> <span class="sql-keyword">AND</span> LEN(QueryName) - LEN(REPLACE(QueryName, <span class="sql-string">'.'</span>, <span class="sql-string">''</span>)) > 5 <span class="sql-keyword">THEN</span> <span class="sql-string">'DEEP_SUBDOMAIN'</span>
            <span class="sql-keyword">ELSE</span> <span class="sql-string">'NORMAL'</span>
        <span class="sql-keyword">END</span> <span class="sql-keyword">as</span> AnomalyType,
        <span class="sql-comment">-- Calculate entropy of query names</span>
        (QueryCount * LOG(QueryCount) - SUM(LOG(QueryCount)) OVER (PARTITION <span class="sql-keyword">BY</span> ClientIP)) / QueryCount <span class="sql-keyword">as</span> QueryEntropy
    <span class="sql-keyword">FROM</span> DNSStats
    <span class="sql-keyword">WHERE</span> AvgQueryLength > 30 <span class="sql-keyword">OR</span> QueryCount > 100 <span class="sql-keyword">OR</span> UniqueQueries > 50
)
<span class="sql-keyword">SELECT</span> 
    ClientIP,
    COUNT(DISTINCT QueryName) <span class="sql-keyword">as</span> SuspiciousQueries,
    SUM(QueryCount) <span class="sql-keyword">as</span> TotalQueries,
    AVG(AvgQueryLength) <span class="sql-keyword">as</span> AvgQueryLength,
    STRING_AGG(AnomalyType, <span class="sql-string">','</span>) <span class="sql-keyword">as</span> AnomalyTypes,
    AVG(QueryEntropy) <span class="sql-keyword">as</span> AvgEntropy
<span class="sql-keyword">FROM</span> SuspiciousDNS
<span class="sql-keyword">WHERE</span> AnomalyType != <span class="sql-string">'NORMAL'</span>
<span class="sql-keyword">GROUP BY</span> ClientIP
<span class="sql-keyword">HAVING</span> COUNT(DISTINCT QueryName) > 10
<span class="sql-keyword">ORDER BY</span> TotalQueries <span class="sql-keyword">DESC</span>, AvgEntropy <span class="sql-keyword">DESC</span>
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                        `
                    },
                    {
                        title: 'Threat Intelligence Integration',
                        content: `
                            <h4>Intelligence-Driven Hunting</h4>
                            <p>Integrating threat intelligence into proactive hunting operations:</p>
                            
                            <div class="code-block" data-lang="Python">
                                <code class="language-python">
<span class="python-keyword">class</span> IntelligenceDrivenHunting:
    <span class="python-keyword">def</span> __init__(self):
        <span class="python-keyword">self</span>.ti_sources = {
            <span class="python-string">'commercial'</span>: [<span class="python-string">'CrowdStrike'</span>, <span class="python-string">'FireEye'</span>, <span class="python-string">'Recorded Future'</span>],
            <span class="python-string">'open_source'</span>: [<span class="python-string">'MISP'</span>, <span class="python-string">'OTX'</span>, <span class="python-string">'ThreatFox'</span>],
            <span class="python-string">'internal'</span>: [<span class="python-string">'Previous Incidents'</span>, <span class="python-string">'Honeypot Data'</span>, <span class="python-string">'Deception Tech'</span>]
        }
    
    <span class="python-keyword">def</span> create_intelligence_hunt(self, threat_actor, campaign=<span class="python-keyword">None</span>):
        <span class="python-string">"""Create hunting operations based on threat intelligence"""</span>
        
        <span class="python-comment"># Gather intelligence on threat actor</span>
        actor_profile = <span class="python-keyword">self</span>.get_actor_profile(threat_actor)
        ttps = <span class="python-keyword">self</span>.get_actor_ttps(threat_actor, campaign)
        
        <span class="python-comment"># Map TTPs to hunting techniques</span>
        hunting_techniques = <span class="python-keyword">self</span>.map_ttps_to_hunting(ttps)
        
        <span class="python-comment"># Generate hunting queries</span>
        hunting_queries = []
        <span class="python-keyword">for</span> technique <span class="python-keyword">in</span> hunting_techniques:
            queries = <span class="python-keyword">self</span>.generate_technique_queries(technique)
            hunting_queries.extend(queries)
        
        <span class="python-comment"># Create hunting timeline</span>
        hunting_timeline = <span class="python-keyword">self</span>.create_hunting_timeline(actor_profile, ttps)
        
        <span class="python-keyword">return</span> {
            <span class="python-string">'actor_profile'</span>: actor_profile,
            <span class="python-string">'ttps'</span>: ttps,
            <span class="python-string">'hunting_queries'</span>: hunting_queries,
            <span class="python-string">'timeline'</span>: hunting_timeline,
            <span class="python-string">'success_criteria'</span>: <span class="python-keyword">self</span>.define_success_criteria(ttps)
        }
    
    <span class="python-keyword">def</span> diamond_model_hunting(self, diamond_elements):
        <span class="python-string">"""Use Diamond Model for structured hunting"""</span>
        hunt_plan = {}
        
        <span class="python-comment"># Adversary-centric hunting</span>
        <span class="python-keyword">if</span> diamond_elements.get(<span class="python-string">'adversary'</span>):
            hunt_plan[<span class="python-string">'adversary'</span>] = <span class="python-keyword">self</span>.hunt_by_adversary(diamond_elements[<span class="python-string">'adversary'</span>])
        
        <span class="python-comment"># Capability-centric hunting</span>
        <span class="python-keyword">if</span> diamond_elements.get(<span class="python-string">'capability'</span>):
            hunt_plan[<span class="python-string">'capability'</span>] = <span class="python-keyword">self</span>.hunt_by_capability(diamond_elements[<span class="python-string">'capability'</span>])
        
        <span class="python-comment"># Infrastructure-centric hunting</span>
        <span class="python-keyword">if</span> diamond_elements.get(<span class="python-string">'infrastructure'</span>):
            hunt_plan[<span class="python-string">'infrastructure'</span>] = <span class="python-keyword">self</span>.hunt_by_infrastructure(diamond_elements[<span class="python-string">'infrastructure'</span>])
        
        <span class="python-comment"># Victim-centric hunting</span>
        <span class="python-keyword">if</span> diamond_elements.get(<span class="python-string">'victim'</span>):
            hunt_plan[<span class="python-string">'victim'</span>] = <span class="python-keyword">self</span>.hunt_by_victim_profile(diamond_elements[<span class="python-string">'victim'</span>])
        
        <span class="python-keyword">return</span> <span class="python-keyword">self</span>.correlate_diamond_findings(hunt_plan)
    
    <span class="python-keyword">def</span> mitre_attack_hunting(self, technique_id):
        <span class="python-string">"""Generate hunting queries for specific MITRE ATT&CK techniques"""</span>
        technique_data = <span class="python-keyword">self</span>.get_mitre_technique_data(technique_id)
        
        hunting_approaches = {
            <span class="python-string">'process_creation'</span>: <span class="python-keyword">self</span>.generate_process_hunting_queries(technique_data),
            <span class="python-string">'network_connections'</span>: <span class="python-keyword">self</span>.generate_network_hunting_queries(technique_data),
            <span class="python-string">'file_system'</span>: <span class="python-keyword">self</span>.generate_file_system_hunting_queries(technique_data),
            <span class="python-string">'registry'</span>: <span class="python-keyword">self</span>.generate_registry_hunting_queries(technique_data),
            <span class="python-string">'authentication'</span>: <span class="python-keyword">self</span>.generate_auth_hunting_queries(technique_data)
        }
        
        <span class="python-keyword">return</span> hunting_approaches
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            
                            <div class="info-box">
                                <strong>Pro Tip:</strong> Implement continuous threat intelligence feeds to automatically update hunting queries and detection rules based on emerging threat landscapes.
                            </div>
                        `
                    }
                ]
            },
            'dfir': {
                title: 'Digital Forensics & Incident Response',
                description: 'Advanced DFIR methodologies, memory analysis, and forensic investigation techniques.',
                sections: [
                    {
                        title: 'Advanced Memory Analysis',
                        content: `
                            <h4>Volatility 3 Advanced Techniques</h4>
                            <p>Comprehensive memory analysis for sophisticated malware detection:</p>
                            
                            <div class="code-block" data-lang="Bash">
                                <code class="language-bash">
<span class="bash-comment"># Advanced Volatility 3 analysis workflow</span>
<span class="bash-keyword">#!/bin/bash</span>

MEMORY_DUMP=<span class="bash-string">"suspect_memory.dmp"</span>
OUTPUT_DIR=<span class="bash-string">"volatility_analysis"</span>

<span class="bash-comment"># Create output directory</span>
mkdir -p $OUTPUT_DIR

<span class="bash-comment"># System information and process analysis</span>
vol3 -f $MEMORY_DUMP windows.info > $OUTPUT_DIR/system_info.txt
vol3 -f $MEMORY_DUMP windows.pslist > $OUTPUT_DIR/processes.txt
vol3 -f $MEMORY_DUMP windows.pstree > $OUTPUT_DIR/process_tree.txt

<span class="bash-comment"># Advanced process analysis</span>
vol3 -f $MEMORY_DUMP windows.malfind > $OUTPUT_DIR/malfind.txt
vol3 -f $MEMORY_DUMP windows.hollowfind > $OUTPUT_DIR/hollowfind.txt
vol3 -f $MEMORY_DUMP windows.dlllist > $OUTPUT_DIR/dll_list.txt

<span class="bash-comment"># Network analysis</span>
vol3 -f $MEMORY_DUMP windows.netstat > $OUTPUT_DIR/network_connections.txt
vol3 -f $MEMORY_DUMP windows.netscan > $OUTPUT_DIR/network_scan.txt

<span class="bash-comment"># Registry analysis</span>
vol3 -f $MEMORY_DUMP windows.registry.hivelist > $OUTPUT_DIR/registry_hives.txt
vol3 -f $MEMORY_DUMP windows.registry.printkey -K <span class="bash-string">"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"</span> > $OUTPUT_DIR/autorun_keys.txt

<span class="bash-comment"># Advanced malware analysis</span>
vol3 -f $MEMORY_DUMP windows.vadinfo > $OUTPUT_DIR/vad_info.txt
vol3 -f $MEMORY_DUMP windows.vadyarascan -Y /path/to/malware_rules.yar > $OUTPUT_DIR/yara_scan.txt

<span class="bash-comment"># Timeline analysis</span>
vol3 -f $MEMORY_DUMP timeliner.Timeliner > $OUTPUT_DIR/timeline.txt

<span class="bash-comment"># Rootkit detection</span>
vol3 -f $MEMORY_DUMP windows.ssdt > $OUTPUT_DIR/ssdt.txt
vol3 -f $MEMORY_DUMP windows.callbacks > $OUTPUT_DIR/callbacks.txt
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            
                            <h4>Custom Memory Analysis Scripts</h4>
                            <div class="code-block" data-lang="Python">
                                <code class="language-python">
<span class="python-keyword">import</span> volatility3.framework.plugins.windows <span class="python-keyword">as</span> windows
<span class="python-keyword">import</span> volatility3.framework.symbols <span class="python-keyword">as</span> symbols

<span class="python-keyword">class</span> AdvancedMalwareHunter:
    <span class="python-keyword">def</span> __init__(self, memory_dump):
        <span class="python-keyword">self</span>.memory_dump = memory_dump
        <span class="python-keyword">self</span>.context = <span class="python-keyword">self</span>.create_context()
    
    <span class="python-keyword">def</span> hunt_advanced_persistence(self):
        <span class="python-string">"""Hunt for advanced persistence mechanisms"""</span>
        persistence_techniques = {
            <span class="python-string">'registry_persistence'</span>: <span class="python-keyword">self</span>.check_registry_persistence(),
            <span class="python-string">'service_persistence'</span>: <span class="python-keyword">self</span>.check_service_persistence(),
            <span class="python-string">'dll_hijacking'</span>: <span class="python-keyword">self</span>.check_dll_hijacking(),
            <span class="python-string">'process_hollowing'</span>: <span class="python-keyword">self</span>.check_process_hollowing(),
            <span class="python-string">'reflective_dll_loading'</span>: <span class="python-keyword">self</span>.check_reflective_dll_loading()
        }
        
        <span class="python-keyword">return</span> persistence_techniques
    
    <span class="python-keyword">def</span> analyze_code_injection(self):
        <span class="python-string">"""Detect various code injection techniques"""</span>
        injection_analysis = {
            <span class="python-string">'process_hollowing'</span>: <span class="python-keyword">self</span>.detect_process_hollowing(),
            <span class="python-string">'dll_injection'</span>: <span class="python-keyword">self</span>.detect_dll_injection(),
            <span class="python-string">'atom_bombing'</span>: <span class="python-keyword">self</span>.detect_atom_bombing(),
            <span class="python-string">'process_doppelganging'</span>: <span class="python-keyword">self</span>.detect_process_doppelganging(),
            <span class="python-string">'manual_dll_loading'</span>: <span class="python-keyword">self</span>.detect_manual_dll_loading()
        }
        
        <span class="python-keyword">return</span> injection_analysis
    
    <span class="python-keyword">def</span> advanced_rootkit_detection(self):
        <span class="python-string">"""Advanced rootkit detection techniques"""</span>
        rootkit_indicators = {
            <span class="python-string">'ssdt_hooks'</span>: <span class="python-keyword">self</span>.detect_ssdt_hooks(),
            <span class="python-string">'idt_hooks'</span>: <span class="python-keyword">self</span>.detect_idt_hooks(),
            <span class="python-string">'inline_hooks'</span>: <span class="python-keyword">self</span>.detect_inline_hooks(),
            <span class="python-string">'callback_modifications'</span>: <span class="python-keyword">self</span>.detect_callback_modifications(),
            <span class="python-string">'driver_hiding'</span>: <span class="python-keyword">self</span>.detect_driver_hiding()
        }
        
        <span class="python-keyword">return</span> rootkit_indicators
    
    <span class="python-keyword">def</span> behavioral_analysis(self):
        <span class="python-string">"""Behavioral analysis of processes"""</span>
        behaviors = {}
        
        <span class="python-keyword">for</span> process <span class="python-keyword">in</span> <span class="python-keyword">self</span>.get_processes():
            process_behavior = {
                <span class="python-string">'network_activity'</span>: <span class="python-keyword">self</span>.analyze_network_behavior(process),
                <span class="python-string">'file_operations'</span>: <span class="python-keyword">self</span>.analyze_file_operations(process),
                <span class="python-string">'registry_operations'</span>: <span class="python-keyword">self</span>.analyze_registry_operations(process),
                <span class="python-string">'crypto_operations'</span>: <span class="python-keyword">self</span>.detect_crypto_operations(process),
                <span class="python-string">'anti_analysis'</span>: <span class="python-keyword">self</span>.detect_anti_analysis_techniques(process)
            }
            
            behaviors[process.pid] = process_behavior
        
        <span class="python-keyword">return</span> behaviors
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            
                            <div class="warning-box">
                                <strong>Memory Analysis Best Practices:</strong> Always create multiple memory dumps during an incident, analyze from a clean forensic workstation, and maintain proper chain of custody documentation.
                            </div>
                        `
                    },
                    {
                        title: 'Advanced Disk Forensics',
                        content: `
                            <h4>Modern File System Analysis</h4>
                            <p>Advanced techniques for NTFS, ReFS, and modern file systems:</p>
                            
                            <div class="code-block" data-lang="Python">
                                <code class="language-python">
<span class="python-keyword">class</span> AdvancedDiskForensics:
    <span class="python-keyword">def</span> __init__(self, disk_image):
        <span class="python-keyword">self</span>.disk_image = disk_image
        <span class="python-keyword">self</span>.filesystem = <span class="python-keyword">self</span>.detect_filesystem()
        <span class="python-keyword">self</span>.mft_parser = <span class="python-keyword">self</span>.initialize_mft_parser()
    
    <span class="python-keyword">def</span> analyze_mft_anomalies(self):
        <span class="python-string">"""Advanced MFT analysis for file system anomalies"""</span>
        mft_records = <span class="python-keyword">self</span>.parse_mft()
        anomalies = {}
        
        <span class="python-comment"># Timestomping detection</span>
        timestomping_indicators = <span class="python-keyword">self</span>.detect_timestomping(mft_records)
        
        <span class="python-comment"># File hiding techniques</span>
        hidden_files = <span class="python-keyword">self</span>.detect_hidden_files(mft_records)
        
        <span class="python-comment"># Alternate data streams</span>
        ads_analysis = <span class="python-keyword">self</span>.analyze_alternate_data_streams(mft_records)
        
        <span class="python-comment"># Slack space analysis</span>
        slack_space_artifacts = <span class="python-keyword">self</span>.analyze_slack_space()
        
        <span class="python-comment"># Journal analysis</span>
        journal_artifacts = <span class="python-keyword">self</span>.analyze_usn_journal()
        
        <span class="python-keyword">return</span> {
            <span class="python-string">'timestomping'</span>: timestomping_indicators,
            <span class="python-string">'hidden_files'</span>: hidden_files,
            <span class="python-string">'ads_analysis'</span>: ads_analysis,
            <span class="python-string">'slack_space'</span>: slack_space_artifacts,
            <span class="python-string">'journal'</span>: journal_artifacts
        }
    
    <span class="python-keyword">def</span> advanced_artifact_recovery(self):
        <span class="python-string">"""Recover advanced artifacts and evidence"""</span>
        artifacts = {}
        
        <span class="python-comment"># Browser artifacts</span>
        artifacts[<span class="python-string">'browsers'</span>] = <span class="python-keyword">self</span>.extract_browser_artifacts()
        
        <span class="python-comment"># Cloud storage artifacts</span>
        artifacts[<span class="python-string">'cloud_storage'</span>] = <span class="python-keyword">self</span>.extract_cloud_storage_artifacts()
        
        <span class="python-comment"># Communication artifacts</span>
        artifacts[<span class="python-string">'communications'</span>] = <span class="python-keyword">self</span>.extract_communication_artifacts()
        
        <span class="python-comment"># Cryptocurrency artifacts</span>
        artifacts[<span class="python-string">'cryptocurrency'</span>] = <span class="python-keyword">self</span>.extract_crypto_artifacts()
        
        <span class="python-comment"># Virtualization artifacts</span>
        artifacts[<span class="python-string">'virtualization'</span>] = <span class="python-keyword">self</span>.extract_vm_artifacts()
        
        <span class="python-keyword">return</span> artifacts
    
    <span class="python-keyword">def</span> timeline_analysis(self):
        <span class="python-string">"""Create comprehensive timeline analysis"""</span>
        timeline_sources = {
            <span class="python-string">'mft_records'</span>: <span class="python-keyword">self</span>.get_mft_timeline(),
            <span class="python-string">'event_logs'</span>: <span class="python-keyword">self</span>.get_event_log_timeline(),
            <span class="python-string">'registry_timeline'</span>: <span class="python-keyword">self</span>.get_registry_timeline(),
            <span class="python-string">'browser_timeline'</span>: <span class="python-keyword">self</span>.get_browser_timeline(),
            <span class="python-string">'application_logs'</span>: <span class="python-keyword">self</span>.get_application_timeline()
        }
        
        <span class="python-comment"># Correlate timestamps across sources</span>
        correlated_timeline = <span class="python-keyword">self</span>.correlate_timelines(timeline_sources)
        
        <span class="python-comment"># Identify suspicious time gaps</span>
        suspicious_gaps = <span class="python-keyword">self</span>.identify_suspicious_gaps(correlated_timeline)
        
        <span class="python-keyword">return</span> {
            <span class="python-string">'timeline'</span>: correlated_timeline,
            <span class="python-string">'suspicious_gaps'</span>: suspicious_gaps,
            <span class="python-string">'key_events'</span>: <span class="python-keyword">self</span>.identify_key_events(correlated_timeline)
        }
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            
                            <h4>Advanced Registry Analysis</h4>
                            <div class="code-block" data-lang="PowerShell">
                                <code class="language-powershell">
<span class="powershell-comment"># Advanced Registry Analysis for DFIR</span>
<span class="powershell-comment"># Analyze registry for malware persistence and system modifications</span>

<span class="powershell-comment"># Registry locations for persistence analysis</span>
$PersistenceKeys = @(
    <span class="powershell-string">"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"</span>,
    <span class="powershell-string">"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce"</span>,
    <span class="powershell-string">"HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"</span>,
    <span class="powershell-string">"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon"</span>,
    <span class="powershell-string">"HKLM\\SYSTEM\\CurrentControlSet\\Services"</span>,
    <span class="powershell-string">"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects"</span>,
    <span class="powershell-string">"HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run"</span>
)

<span class="powershell-comment"># Function to analyze registry modifications</span>
<span class="powershell-keyword">function</span> Analyze-RegistryModifications {
    <span class="powershell-keyword">param</span>(
        <span class="powershell-keyword">[string]</span>$RegistryHive,
        <span class="powershell-keyword">[datetime]</span>$IncidentStartTime,
        <span class="powershell-keyword">[datetime]</span>$IncidentEndTime
    )
    
    $SuspiciousEntries = @()
    
    <span class="powershell-keyword">foreach</span> ($Key <span class="powershell-keyword">in</span> $PersistenceKeys) {
        <span class="powershell-keyword">try</span> {
            $RegEntries = <span class="powershell-keyword">Get-ItemProperty</span> <span class="powershell-keyword">-Path</span> <span class="powershell-string">"Registry::$Key"</span> <span class="powershell-keyword">-ErrorAction</span> SilentlyContinue
            
            <span class="powershell-keyword">foreach</span> ($Entry <span class="powershell-keyword">in</span> $RegEntries.PSObject.Properties) {
                <span class="powershell-keyword">if</span> ($Entry.Name <span class="powershell-keyword">-notlike</span> <span class="powershell-string">"PS*"</span>) {
                    $EntryDetails = @{
                        Key = $Key
                        Name = $Entry.Name
                        Value = $Entry.Value
                        Type = $Entry.TypeNameOfValue
                        SuspiciousIndicators = @()
                    }
                    
                    <span class="powershell-comment"># Check for suspicious patterns</span>
                    <span class="powershell-keyword">if</span> ($Entry.Value <span class="powershell-keyword">-match</span> <span class="powershell-string">"powershell|cmd|regsvr32|rundll32|certutil"</span>) {
                        $EntryDetails.SuspiciousIndicators <span class="powershell-keyword">+=</span> <span class="powershell-string">"Suspicious Process"</span>
                    }
                    
                    <span class="powershell-keyword">if</span> ($Entry.Value <span class="powershell-keyword">-match</span> <span class="powershell-string">"http|ftp|\\\\S"</span>) {
                        $EntryDetails.SuspiciousIndicators <span class="powershell-keyword">+=</span> <span class="powershell-string">"Network Resource"</span>
                    }
                    
                    <span class="powershell-keyword">if</span> ($Entry.Value <span class="powershell-keyword">-match</span> <span class="powershell-string">"temp|appdata|programdata"</span>) {
                        $EntryDetails.SuspiciousIndicators <span class="powershell-keyword">+=</span> <span class="powershell-string">"Suspicious Location"</span>
                    }
                    
                    <span class="powershell-keyword">if</span> ($EntryDetails.SuspiciousIndicators.Count <span class="powershell-keyword">-gt</span> 0) {
                        $SuspiciousEntries <span class="powershell-keyword">+=</span> $EntryDetails
                    }
                }
            }
        }
        <span class="powershell-keyword">catch</span> {
            <span class="powershell-keyword">Write-Warning</span> <span class="powershell-string">"Could not access registry key: $Key"</span>
        }
    }
    
    <span class="powershell-keyword">return</span> $SuspiciousEntries
}

<span class="powershell-comment"># Advanced shimcache analysis</span>
<span class="powershell-keyword">function</span> Analyze-Shimcache {
    $ShimcacheEntries = <span class="powershell-keyword">Get-ItemProperty</span> <span class="powershell-keyword">-Path</span> <span class="powershell-string">"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\AppCompatCache"</span> <span class="powershell-keyword">-Name</span> AppCompatCache
    
    <span class="powershell-comment"># Parse shimcache entries (simplified)</span>
    $ParsedEntries = @()
    
    <span class="powershell-comment"># This would require binary parsing of the shimcache data</span>
    <span class="powershell-comment"># Implementation would depend on the specific shimcache format</span>
    
    <span class="powershell-keyword">return</span> $ParsedEntries
}

<span class="powershell-comment"># Execute comprehensive registry analysis</span>
$IncidentStart = (Get-Date).AddDays(-7) <span class="powershell-comment"># Example: Last 7 days</span>
$IncidentEnd = Get-Date

$RegistryAnalysis = @{
    PersistenceAnalysis = <span class="powershell-keyword">Analyze-RegistryModifications</span> <span class="powershell-keyword">-RegistryHive</span> <span class="powershell-string">"SYSTEM"</span> <span class="powershell-keyword">-IncidentStartTime</span> $IncidentStart <span class="powershell-keyword">-IncidentEndTime</span> $IncidentEnd
    ShimcacheAnalysis = <span class="powershell-keyword">Analyze-Shimcache</span>
    RecentDocs = <span class="powershell-keyword">Get-ItemProperty</span> <span class="powershell-keyword">-Path</span> <span class="powershell-string">"HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs"</span> <span class="powershell-keyword">-ErrorAction</span> SilentlyContinue
    TypedURLs = <span class="powershell-keyword">Get-ItemProperty</span> <span class="powershell-keyword">-Path</span> <span class="powershell-string">"HKCU\\SOFTWARE\\Microsoft\\Internet Explorer\\TypedURLs"</span> <span class="powershell-keyword">-ErrorAction</span> SilentlyContinue
}

$RegistryAnalysis <span class="powershell-keyword">| ConvertTo-Json</span> <span class="powershell-keyword">-Depth</span> 4
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                        `
                    },
                    {
                        title: 'Network Forensics',
                        content: `
                            <h4>Advanced PCAP Analysis</h4>
                            <p>Comprehensive network forensics and traffic analysis:</p>
                            
                            <div class="code-block" data-lang="Python">
                                <code class="language-python">
<span class="python-keyword">import</span> scapy.all <span class="python-keyword">as</span> scapy
<span class="python-keyword">import</span> dpkt
<span class="python-keyword">import</span> socket
<span class="python-keyword">import</span> binascii
<span class="python-keyword">from</span> collections <span class="python-keyword">import</span> defaultdict

<span class="python-keyword">class</span> NetworkForensicsAnalyzer:
    <span class="python-keyword">def</span> __init__(self, pcap_file):
        <span class="python-keyword">self</span>.pcap_file = pcap_file
        <span class="python-keyword">self</span>.flows = defaultdict(list)
        <span class="python-keyword">self</span>.dns_queries = []
        <span class="python-keyword">self</span>.http_requests = []
        <span class="python-keyword">self</span>.suspicious_traffic = []
    
    <span class="python-keyword">def</span> comprehensive_traffic_analysis(self):
        <span class="python-string">"""Comprehensive analysis of network traffic"""</span>
        <span class="python-keyword">with</span> open(<span class="python-keyword">self</span>.pcap_file, <span class="python-string">'rb'</span>) <span class="python-keyword">as</span> f:
            pcap = dpkt.pcap.Reader(f)
            
            <span class="python-keyword">for</span> timestamp, buf <span class="python-keyword">in</span> pcap:
                eth = dpkt.ethernet.Ethernet(buf)
                
                <span class="python-keyword">if</span> <span class="python-keyword">isinstance</span>(eth.data, dpkt.ip.IP):
                    ip = eth.data
                    
                    <span class="python-comment"># Flow analysis</span>
                    flow_key = <span class="python-keyword">self</span>.create_flow_key(ip)
                    <span class="python-keyword">self</span>.flows[flow_key].append((timestamp, ip))
                    
                    <span class="python-comment"># Protocol-specific analysis</span>
                    <span class="python-keyword">if</span> <span class="python-keyword">isinstance</span>(ip.data, dpkt.tcp.TCP):
                        <span class="python-keyword">self</span>.analyze_tcp_traffic(timestamp, ip, ip.data)
                    <span class="python-keyword">elif</span> <span class="python-keyword">isinstance</span>(ip.data, dpkt.udp.UDP):
                        <span class="python-keyword">self</span>.analyze_udp_traffic(timestamp, ip, ip.data)
        
        <span class="python-keyword">return</span> <span class="python-keyword">self</span>.generate_forensics_report()
    
    <span class="python-keyword">def</span> analyze_tcp_traffic(self, timestamp, ip, tcp):
        <span class="python-string">"""Advanced TCP traffic analysis"""</span>
        <span class="python-comment"># HTTP analysis</span>
        <span class="python-keyword">if</span> tcp.dport == 80 <span class="python-keyword">or</span> tcp.sport == 80:
            <span class="python-keyword">self</span>.analyze_http_traffic(timestamp, ip, tcp)
        
        <span class="python-comment"># HTTPS analysis</span>
        <span class="python-keyword">elif</span> tcp.dport == 443 <span class="python-keyword">or</span> tcp.sport == 443:
            <span class="python-keyword">self</span>.analyze_https_traffic(timestamp, ip, tcp)
        
        <span class="python-comment"># Suspicious port analysis</span>
        <span class="python-keyword">elif</span> tcp.dport <span class="python-keyword">in</span> <span class="python-keyword">self</span>.get_suspicious_ports():
            <span class="python-keyword">self</span>.flag_suspicious_traffic(timestamp, ip, tcp, <span class="python-string">"Suspicious Port"</span>)
    
    <span class="python-keyword">def</span> detect_data_exfiltration(self):
        <span class="python-string">"""Detect potential data exfiltration patterns"""</span>
        exfiltration_indicators = {}
        
        <span class="python-comment"># Large data transfers</span>
        large_transfers = <span class="python-keyword">self</span>.detect_large_transfers()
        
        <span class="python-comment"># Unusual timing patterns</span>
        timing_anomalies = <span class="python-keyword">self</span>.detect_timing_anomalies()
        
        <span class="python-comment"># DNS tunneling</span>
        dns_tunneling = <span class="python-keyword">self</span>.detect_dns_tunneling()
        
        <span class="python-comment"># Encrypted traffic analysis</span>
        encrypted_anomalies = <span class="python-keyword">self</span>.analyze_encrypted_traffic()
        
        <span class="python-keyword">return</span> {
            <span class="python-string">'large_transfers'</span>: large_transfers,
            <span class="python-string">'timing_anomalies'</span>: timing_anomalies,
            <span class="python-string">'dns_tunneling'</span>: dns_tunneling,
            <span class="python-string">'encrypted_anomalies'</span>: encrypted_anomalies
        }
    
    <span class="python-keyword">def</span> analyze_malware_communications(self):
        <span class="python-string">"""Analyze network communications for malware indicators"""</span>
        malware_indicators = {}
        
        <span class="python-comment"># C2 communication patterns</span>
        c2_patterns = <span class="python-keyword">self</span>.detect_c2_communications()
        
        <span class="python-comment"># Beaconing analysis</span>
        beaconing_analysis = <span class="python-keyword">self</span>.detect_beaconing()
        
        <span class="python-comment"># Domain generation algorithms</span>
        dga_analysis = <span class="python-keyword">self</span>.detect_dga_domains()
        
        <span class="python-comment"># Fast flux analysis</span>
        fast_flux_analysis = <span class="python-keyword">self</span>.detect_fast_flux()
        
        <span class="python-keyword">return</span> {
            <span class="python-string">'c2_patterns'</span>: c2_patterns,
            <span class="python-string">'beaconing'</span>: beaconing_analysis,
            <span class="python-string">'dga_domains'</span>: dga_analysis,
            <span class="python-string">'fast_flux'</span>: fast_flux_analysis
        }
    
    <span class="python-keyword">def</span> extract_files_from_traffic(self):
        <span class="python-string">"""Extract files transferred over the network"""</span>
        extracted_files = []
        
        <span class="python-comment"># HTTP file extraction</span>
        http_files = <span class="python-keyword">self</span>.extract_http_files()
        
        <span class="python-comment"># FTP file extraction</span>
        ftp_files = <span class="python-keyword">self</span>.extract_ftp_files()
        
        <span class="python-comment"># Email attachment extraction</span>
        email_attachments = <span class="python-keyword">self</span>.extract_email_attachments()
        
        <span class="python-comment"># SMB file extraction</span>
        smb_files = <span class="python-keyword">self</span>.extract_smb_files()
        
        <span class="python-keyword">return</span> {
            <span class="python-string">'http_files'</span>: http_files,
            <span class="python-string">'ftp_files'</span>: ftp_files,
            <span class="python-string">'email_attachments'</span>: email_attachments,
            <span class="python-string">'smb_files'</span>: smb_files
        }
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            
                            <h4>Advanced DNS Analysis</h4>
                            <div class="code-block" data-lang="Python">
                                <code class="language-python">
<span class="python-keyword">def</span> analyze_dns_for_malware(dns_logs):
    <span class="python-string">"""Advanced DNS analysis for malware detection"""</span>
    
    <span class="python-comment"># DGA domain detection</span>
    dga_indicators = {
        <span class="python-string">'high_entropy_domains'</span>: [],
        <span class="python-string">'numerical_domains'</span>: [],
        <span class="python-string">'long_subdomains'</span>: [],
        <span class="python-string">'newly_registered'</span>: []
    }
    
    <span class="python-comment"># DNS tunneling detection</span>
    tunneling_indicators = {
        <span class="python-string">'large_txt_records'</span>: [],
        <span class="python-string">'high_query_frequency'</span>: [],
        <span class="python-string">'unusual_record_types'</span>: [],
        <span class="python-string">'base64_encoded_data'</span>: []
    }
    
    <span class="python-comment"># Fast flux detection</span>
    fast_flux_indicators = {
        <span class="python-string">'rapid_ip_changes'</span>: [],
        <span class="python-string">'short_ttl_values'</span>: [],
        <span class="python-string">'multiple_a_records'</span>: []
    }
    
    <span class="python-keyword">for</span> dns_record <span class="python-keyword">in</span> dns_logs:
        domain = dns_record[<span class="python-string">'query_name'</span>]
        
        <span class="python-comment"># Calculate domain entropy</span>
        entropy = calculate_entropy(domain)
        <span class="python-keyword">if</span> entropy > 4.5:
            dga_indicators[<span class="python-string">'high_entropy_domains'</span>].append({
                <span class="python-string">'domain'</span>: domain,
                <span class="python-string">'entropy'</span>: entropy,
                <span class="python-string">'timestamp'</span>: dns_record[<span class="python-string">'timestamp'</span>]
            })
        
        <span class="python-comment"># Check for DNS tunneling</span>
        <span class="python-keyword">if</span> dns_record[<span class="python-string">'record_type'</span>] == <span class="python-string">'TXT'</span> <span class="python-keyword">and</span> <span class="python-keyword">len</span>(dns_record[<span class="python-string">'answer'</span>]) > 200:
            tunneling_indicators[<span class="python-string">'large_txt_records'</span>].append(dns_record)
        
        <span class="python-comment"># Fast flux detection</span>
        <span class="python-keyword">if</span> dns_record[<span class="python-string">'ttl'</span>] < 300:
            fast_flux_indicators[<span class="python-string">'short_ttl_values'</span>].append(dns_record)
    
    <span class="python-keyword">return</span> {
        <span class="python-string">'dga_indicators'</span>: dga_indicators,
        <span class="python-string">'tunneling_indicators'</span>: tunneling_indicators,
        <span class="python-string">'fast_flux_indicators'</span>: fast_flux_indicators
    }
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            
                            <div class="info-box">
                                <strong>Network Forensics Tip:</strong> Always analyze network traffic in conjunction with endpoint artifacts. Network forensics provides the "what" and "when", while endpoint forensics provides the "how" and "why".
                            </div>
                        `
                    }
                ]
            },
            // Placeholder for other categories - you can expand these!
            'malware-analysis': {
                title: 'Malware Analysis',
                description: 'In-depth techniques for static, dynamic, and behavioral analysis of malicious software.',
                sections: [
                    {
                        title: 'Dynamic Analysis Techniques',
                        content: `
                            <h4>Automated Sandboxing & Evasion</h4>
                            <p>Understanding and countering sandbox evasion techniques used by advanced malware.</p>
                            <div class="code-block" data-lang="Python">
                                <code class="language-python">
<span class="python-comment"># Example: Simple anti-VM detection in Python (malware perspective)</span>
<span class="python-keyword">import</span> os
<span class="python-keyword">def</span> check_vm():
    <span class="python-keyword">if</span> os.path.exists(<span class="python-string">"/sys/class/dmi/id/product_name"</span>):
        <span class="python-keyword">with</span> open(<span class="python-string">"/sys/class/dmi/id/product_name"</span>, <span class="python-string">"r"</span>) <span class="python-keyword">as</span> f:
            product = f.read().strip().lower()
            <span class="python-keyword">if</span> <span class="python-string">"vmware"</span> <span class="python-keyword">in</span> product <span class="python-keyword">or</span> <span class="python-string">"virtualbox"</span> <span class="python-keyword">in</span> product:
                <span class="python-keyword">return True</span>
    <span class="python-keyword">return False</span>

<span class="python-keyword">if</span> check_vm():
    print(<span class="python-string">"VM detected, exiting..."</span>)
    <span class="python-keyword">exit</span>()
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            <p>Key areas include API hooking, network traffic analysis, and process monitoring to observe malware behavior in a controlled environment.</p>
                        `,
                        tools: [
                            { name: 'Cuckoo Sandbox', description: 'Open-source automated malware analysis system.', tags: ['Open-Source'] },
                            { name: 'Any.Run', description: 'Interactive malware analysis service in the cloud.', tags: ['Freemium'] }
                        ]
                    },
                    {
                        title: 'Static Analysis and Reverse Engineering',
                        content: `
                            <h4>Disassembly & Decompilation Tools</h4>
                            <p>Utilizing tools like IDA Pro and Ghidra to analyze executable binaries without running them.</p>
                            <ul>
                                <li><strong>IDA Pro:</strong> Industry-standard disassembler and debugger for various architectures.</li>
                                <li><strong>Ghidra:</strong> NSA-developed open-source software reverse engineering (SRE) suite.</li>
                            </ul>
                            <div class="code-block" data-lang="Assembly">
                                <code class="language-assembly">
<span class="assembly-comment">; Basic x86 assembly for a function call</span>
push    ebp
mov     ebp, esp
sub     esp, 10h
mov     dword ptr [ebp-4], 0
mov     eax, dword ptr [ebp-4]
push    eax
call    MessageBoxA     <span class="assembly-comment">; Call to WinAPI function</span>
add     esp, 4
leave
retn
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                        `
                    }
                ]
            },
            'network-security': {
                title: 'Network Security',
                description: 'Advanced concepts in network defense, intrusion prevention, and secure network architectures.',
                sections: [
                    {
                        title: 'Intrusion Detection/Prevention Systems (IDPS)',
                        content: `
                            <h4>Next-Gen IPS Capabilities</h4>
                            <p>Exploring advanced features of Next-Generation Intrusion Prevention Systems (NGIPS) beyond signature-based detection.</p>
                            <ul>
                                <li><strong>Behavioral Analysis:</strong> Detecting deviations from normal network behavior.</li>
                                <li><strong>Threat Intelligence Integration:</strong> Automated blocking based on real-time threat feeds.</li>
                                <li><strong>Application Awareness:</strong> Understanding and controlling application-specific traffic.</li>
                            </ul>
                        `,
                        tools: [
                            { name: 'Snort', description: 'Open-source network intrusion prevention and detection system.', tags: ['Open-Source'] },
                            { name: 'Suricata', description: 'High-performance Network IPS, IDS, and Network Security Monitoring engine.', tags: ['Open-Source'] }
                        ]
                    },
                    {
                        title: 'Zero Trust Network Architecture (ZTNA)',
                        content: `
                            <h4>Implementing Zero Trust Principles</h4>
                            <p>Designing and deploying network architectures based on the "never trust, always verify" principle.</p>
                            <div class="info-box">
                                <strong>Key Pillars:</strong> Identity verification, device trust, least privilege access, microsegmentation, and continuous monitoring.
                            </div>
                            <p>ZTNA eliminates the concept of a trusted internal network, enforcing strict access controls regardless of user location.</p>
                        `
                    }
                ]
            },
            'cloud-security': {
                title: 'Cloud Security',
                description: 'Securing cloud environments, including IaaS, PaaS, and SaaS, with advanced strategies.',
                sections: [
                    {
                        title: 'Cloud Workload Protection Platforms (CWPP)',
                        content: `
                            <h4>Comprehensive Cloud Workload Security</h4>
                            <p>CWPP solutions offer integrated security for workloads across multi-cloud and hybrid environments.</p>
                            <ul>
                                <li><strong>Vulnerability Management:</strong> Continuous scanning of cloud assets.</li>
                                <li><strong>Runtime Protection:</strong> Preventing attacks during workload execution.</li>
                                <li><strong>Network Microsegmentation:</strong> Isolating cloud workloads.</li>
                            </ul>
                        `,
                        tools: [
                            { name: 'Palo Alto Networks Prisma Cloud', description: 'Comprehensive cloud native security platform.', tags: ['Commercial'] },
                            { name: 'CrowdStrike Falcon Cloud Workload Protection', description: 'Endpoint and cloud workload security.', tags: ['Commercial'] }
                        ]
                    },
                    {
                        title: 'Cloud Security Posture Management (CSPM)',
                        content: `
                            <h4>Automated Compliance & Misconfiguration Detection</h4>
                            <p>CSPM tools continuously monitor cloud environments for misconfigurations and compliance violations.</p>
                            <div class="code-block" data-lang="JSON">
                                <code class="language-json">
<span class="json-keyword">"ResourcePolicy"</span>: {
    <span class="json-keyword">"Type"</span>: <span class="json-string">"AWS::S3::BucketPolicy"</span>,
    <span class="json-keyword">"Properties"</span>: {
        <span class="json-keyword">"Bucket"</span>: <span class="json-string">"my-sensitive-data-bucket"</span>,
        <span class="json-keyword">"PolicyDocument"</span>: {
            <span class="json-keyword">"Version"</span>: <span class="json-string">"2012-10-17"</span>,
            <span class="json-keyword">"Statement"</span>: [
                {
                    <span class="json-keyword">"Effect"</span>: <span class="json-string">"Allow"</span>,
                    <span class="json-keyword">"Principal"</span>: <span class="json-string">"*"</span>, <span class="json-comment">// WARNING: Public access!</span>
                    <span class="json-keyword">"Action"</span>: <span class="json-string">"s3:GetObject"</span>,
                    <span class="json-keyword">"Resource"</span>: <span class="json-string">"arn:aws:s3:::my-sensitive-data-bucket/*"</span>
                }
            ]
        }
    }
}
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            <p>A misconfigured S3 bucket policy allowing public read access, a common cloud security oversight detected by CSPM.</p>
                        `
                    }
                ]
            },
            'red-team': {
                title: 'Red Team TTPs',
                description: 'Advanced tactics, techniques, and procedures used by red teams for offensive security operations.',
                sections: [
                    {
                        title: 'Initial Access & Execution',
                        content: `
                            <h4>Advanced Phishing & Social Engineering</h4>
                            <p>Beyond basic phishing: Spear-phishing, whaling, watering hole attacks, and vishing techniques.</p>
                            <ul>
                                <li><strong>Pretexting:</strong> Creating believable scenarios to extract information or gain access.</li>
                                <li><strong>Baiting:</strong> Luring targets with tempting offers or compromised media.</li>
                                <li><strong>Tailgating:</strong> Gaining unauthorized access by following an authorized person.</li>
                            </ul>
                        `,
                        tools: [
                            { name: 'GoPhish', description: 'Open-source phishing framework.', tags: ['Open-Source'] },
                            { name: 'SET (Social-Engineer Toolkit)', description: 'Open-source penetration testing framework designed for social engineering.', tags: ['Open-Source'] }
                        ]
                    },
                    {
                        title: 'Lateral Movement & Persistence',
                        content: `
                            <h4>Abusing Active Directory & Kerberos</h4>
                            <p>Techniques like Kerberoasting, Golden Ticket, and Silver Ticket attacks for credential theft and lateral movement.</p>
                            <div class="code-block" data-lang="Bash">
                                <code class="language-bash">
<span class="bash-comment"># Example: Kerberoasting with Rubeus</span>
Rubeus.exe kerberoast /outfile:hashes.txt
                                </code>
                                <button class="copy-button">Copy</button>
                            </div>
                            <p>Establishing persistence through privileged accounts, scheduled tasks, and rogue services.</p>
                        `
                    }
                ]
            },
            'blue-team': {
                title: 'Blue Team Defense',
                description: 'Advanced defensive strategies, security hardening, and proactive defense mechanisms.',
                sections: [
                    {
                        title: 'Endpoint Detection & Response (EDR)',
                        content: `
                            <h4>Maximizing EDR Capabilities</h4>
                            <p>Leveraging EDR solutions for advanced threat detection, investigation, and response at the endpoint level.</p>
                            <ul>
                                <li><strong>Behavioral Analytics:</strong> Identifying anomalous process execution and file access.</li>
                                <li><strong>Threat Hunting:</strong> Proactive searching for indicators of compromise (IOCs) and tactics, techniques, and procedures (TTPs).</li>
                                <li><strong>Automated Remediation:</strong> Rapid containment and elimination of threats.</li>
                            </ul>
                        `,
                        tools: [
                            { name: 'CrowdStrike Falcon Insight', description: 'Cloud-native EDR for comprehensive endpoint protection.', tags: ['Commercial'] },
                            { name: 'Microsoft Defender for Endpoint', description: 'Unified endpoint security platform.', tags: ['Commercial'] }
                        ]
                    },
                    {
                        title: 'Deception Technologies',
                        content: `
                            <h4>Deploying Honeypots & Decoys</h4>
                            <p>Using deception technologies to lure, detect, and analyze attacker behavior within the network.</p>
                            <div class="info-box">
                                <strong>Types of Deception:</strong> Honeypots (low-interaction, high-interaction), honeynets, and decoy documents/credentials.
                            </div>
                            <p>Deception allows defenders to gain early warning of attacks and gather intelligence on adversary TTPs without risking production systems.</p>
                        `
                    }
                ]
            },
            'frameworks': {
                title: 'Frameworks & Standards',
                description: 'Key cybersecurity frameworks, standards, and models for building robust security programs.',
                sections: [
                    {
                        title: 'MITRE ATT&CK Framework',
                        content: `
                            <h4>Mapping Defenses to ATT&CK</h4>
                            <p>Utilizing the MITRE ATT&CK framework to understand adversary TTPs and identify gaps in defensive capabilities.</p>
                            <ul>
                                <li><strong>Coverage Analysis:</strong> Assessing how existing security controls map to ATT&CK techniques.</li>
                                <li><strong>Detection Engineering:</strong> Developing custom detections for specific ATT&CK techniques.</li>
                                <li><strong>Threat Emulation:</strong> Simulating adversary behavior to test defenses.</li>
                            </ul>
                            <p>The framework categorizes and describes common attack techniques, providing a common language for defenders and attackers alike.</p>
                        `,
                        tools: [
                            { name: 'ATT&CK Navigator', description: 'Web-based tool for visualizing and analyzing ATT&CK data.', tags: ['Open-Source', 'Web-Tool'] }
                        ]
                    },
                    {
                        title: 'NIST Cybersecurity Framework',
                        content: `
                            <h4>Implementing the NIST CSF</h4>
                            <p>A comprehensive framework to manage and reduce cybersecurity risk, consisting of five core functions: Identify, Protect, Detect, Respond, and Recover.</p>
                            <div class="info-box">
                                <strong>Benefits:</strong> Improved risk management, better communication, and a standardized approach to cybersecurity across an organization.
                            </div>
                            <p>The NIST CSF is widely adopted by organizations globally for its flexible and scalable approach to cybersecurity risk management.</p>
                        `
                    }
                ]
            }
        };

        const contentDiv = document.getElementById('content');
        const categoryList = document.getElementById('categoryList');
        const searchInput = document.getElementById('searchInput');
        const breadcrumb = document.getElementById('breadcrumb');
        const currentCategorySpan = document.getElementById('currentCategory');
        const mobileMenuToggle = document.getElementById('mobileMenuToggle');
        const sidebar = document.getElementById('sidebar');

        // Function to sanitize and render HTML safely (basic XSS prevention)
        function sanitizeHTML(html) {
            const div = document.createElement('div');
            div.innerHTML = html;
            // More robust sanitation would involve a library like DOMPurify
            return div.innerHTML;
        }

        // Function to apply simple syntax highlighting
        function applySyntaxHighlighting(codeHtml, lang) {
            let highlightedCode = codeHtml;
            // Very basic keyword/string/comment highlighting.
            // For production, consider a dedicated library like highlight.js or Prism.js
            switch (lang) {
                case 'KQL':
                    highlightedCode = highlightedCode
                        .replace(/(let|where|extend|join|kind|inner|on|summarize|count|make_set|min|max|by|datetime_diff|ago|distinct|has_any|in|parse_json|order by|desc)/g, '<span class="kql-keyword">$&</span>')
                        .replace(/(\/\/.*)/g, '<span class="kql-comment">$&</span>')
                        .replace(/(".*?"|'.*?')/g, '<span class="kql-string">$&</span>');
                    break;
                case 'Python':
                    highlightedCode = highlightedCode
                        .replace(/(import|from|class|def|if|else|elif|return|with|for|in|as|try|except|None|True|False)/g, '<span class="python-keyword">$&</span>')
                        .replace(/(#.*)/g, '<span class="python-comment">$&</span>')
                        .replace(/(".*?"|'.*?')/g, '<span class="python-string">$&</span>');
                    break;
                case 'Bash':
                    highlightedCode = highlightedCode
                        .replace(/(\b(mkdir|vol3|push|call|add|leave|retn)\b)/g, '<span class="bash-keyword">$&</span>')
                        .replace(/(#!\/bin\/bash)/g, '<span class="bash-keyword">$&</span>')
                        .replace(/(#.*)/g, '<span class="bash-comment">$&</span>')
                        .replace(/(".*?"|'.*?')/g, '<span class="bash-string">$&</span>');
                    break;
                case 'SQL':
                    highlightedCode = highlightedCode
                        .replace(/(SELECT|FROM|WHERE|GROUP BY|ORDER BY|HAVING|WITH|AS|JOIN|INNER|ON|CASE|WHEN|THEN|ELSE|END|AVG|COUNT|SUM|STDDEV|PERCENTILE_CONT|WITHIN GROUP|DATEADD|GETDATE|CAST|NULLIF|STRING_AGG|DISTINCT|LIKE|NOT|AND|OR)/gi, '<span class="sql-keyword">$&</span>')
                        .replace(/(--.*)/g, '<span class="sql-comment">$&</span>')
                        .replace(/(".*?"|'.*?')/g, '<span class="sql-string">$&</span>');
                    break;
                case 'YAML':
                    highlightedCode = highlightedCode
                        .replace(/^(title|id|description|author|date|references|logsource|category|product|detection|selection_psexec|Image|endswith|CommandLine|contains|selection_wmi|selection_powershell|Invoke-Command|New-PSSession|timeframe|condition|falsepositives|level|tags|attack|lateral_movement|t1021):/gm, '<span class="yaml-keyword">$&</span>')
                        .replace(/(- .*)/g, '<span class="yaml-string">$&</span>'); // Simple string
                    break;
                case 'PowerShell':
                    highlightedCode = highlightedCode
                        .replace(/(\b(function|param|if|else|foreach|in|try|catch|return|Write-Warning|Get-ItemProperty|Set-ItemProperty|Remove-ItemProperty|ConvertTo-Json|Get-Date|AddDays|Get-Content|Set-Content|Out-File|ErrorAction|SilentlyContinue|param)\b)/gi, '<span class="powershell-keyword">$&</span>')
                        .replace(/(#.*)/g, '<span class="powershell-comment">$&</span>')
                        .replace(/(".*?"|'.*?')/g, '<span class="powershell-string">$&</span>');
                    break;
                case 'JSON':
                    highlightedCode = highlightedCode
                        .replace(/(".*?")\s*:/g, '<span class="json-keyword">$&</span>') // Keys
                        .replace(/(".*?")(?!:)/g, '<span class="json-string">$&</span>') // Values
                        .replace(/(\/\/.*)/g, '<span class="json-comment">$&</span>'); // Comments
                    break;
                case 'Assembly':
                    highlightedCode = highlightedCode
                        .replace(/^(push|mov|sub|call|add|leave|retn)/gm, '<span class="assembly-keyword">$&</span>')
                        .replace(/(;.*)/g, '<span class="assembly-comment">$&</span>');
                    break;
                default:
                    // No specific highlighting for unknown languages
                    break;
            }
            return highlightedCode;
        }

        // Function to render content based on category
        function renderContent(categoryKey, query = '') {
            contentDiv.classList.remove('fade-in'); // Remove to re-trigger animation
            contentDiv.innerHTML = `<div class="loading"><div class="spinner"></div><p>Loading advanced insights...</p></div>`;

            setTimeout(() => { // Simulate network delay
                const data = contentData[categoryKey];
                let html = '';

                if (!data) {
                    html = '<div class="no-results"><h3>Content Not Found</h3><p>Apologies, the requested category is not available yet.</p></div>';
                    contentDiv.innerHTML = html;
                    contentDiv.classList.add('fade-in');
                    updateBreadcrumb('Error', 'Content Not Found');
                    return;
                }

                updateBreadcrumb(categoryKey, data.title);

                html += `
                    <div class="topic-header">
                        <h2>${data.title}</h2>
                        <p class="topic-description">${data.description}</p>
                    </div>
                `;

                let foundResults = false;
                data.sections.forEach(section => {
                    const sectionContent = sanitizeHTML(section.content);
                    const lowerCaseSectionContent = sectionContent.toLowerCase();
                    const lowerCaseQuery = query.toLowerCase();

                    // Check if query is in section title or content
                    if (!query || section.title.toLowerCase().includes(lowerCaseQuery) || lowerCaseSectionContent.includes(lowerCaseQuery)) {
                        foundResults = true;
                        let highlightedSectionContent = sectionContent;
                        if (query) {
                            // Basic highlighting for search terms
                            const regex = new RegExp(`(${query})`, 'gi');
                            highlightedSectionContent = highlightedSectionContent.replace(regex, '<span class="highlight">$&</span>');
                        }

                        let toolsHtml = '';
                        if (section.tools && section.tools.length > 0) {
                            toolsHtml += `<div class="tools-grid">`;
                            section.tools.forEach(tool => {
                                let tagHtml = '';
                                tool.tags.forEach(tag => {
                                    const tagClass = tag.toLowerCase().replace(/ /g, '-'); // "Real-time" -> "real-time"
                                    tagHtml += `<span class="tag ${tagClass}">${tag}</span>`;
                                });
                                toolsHtml += `
                                    <div class="tool-card">
                                        <div>
                                            <div class="tool-name">${tool.name}</div>
                                            <p>${tool.description}</p>
                                        </div>
                                        <div class="tag-container">
                                            ${tagHtml}
                                        </div>
                                    </div>
                                `;
                            });
                            toolsHtml += `</div>`;
                        }

                        html += `
                            <div class="section">
                                <h3>${section.title}</h3>
                                ${highlightedSectionContent}
                                ${toolsHtml}
                            </div>
                        `;
                    }
                });

                if (!foundResults && query) {
                    html = `<div class="no-results"><h3>No results found for "${query}" in ${data.title}</h3><p>Try a different search term or category.</p></div>`;
                } else if (!foundResults && !query) {
                     // This case should ideally not happen if data is always present for a category
                     html = '<div class="no-results"><h3>No content available for this category.</h3></div>';
                }

                contentDiv.innerHTML = html;
                contentDiv.classList.add('fade-in');

                // Add copy functionality to code blocks
                addCopyButtonListeners();
                applyAllCodeBlockSyntaxHighlighting();

            }, 200); // Small delay for loading effect
        }

        // Function to update breadcrumb
        function updateBreadcrumb(categoryKey, categoryTitle) {
            currentCategorySpan.textContent = categoryTitle;
            breadcrumb.querySelector('a').onclick = () => {
                showCategory(categoryKey); // Click 'Home' to reload current category without search query
                searchInput.value = ''; // Clear search on breadcrumb home click
                return false;
            };
        }

        // Function to handle category clicks
        function showCategory(categoryKey) {
            // Remove active class from all categories
            document.querySelectorAll('.category-item').forEach(item => {
                item.classList.remove('active');
            });

            // Add active class to the clicked category
            const activeCategoryItem = document.querySelector(`.category-item[data-category="${categoryKey}"]`);
            if (activeCategoryItem) {
                activeCategoryItem.classList.add('active');
            } else {
                // If the category key is 'home' or invalid, default to the first one
                document.querySelector('.category-item').classList.add('active');
                categoryKey = document.querySelector('.category-item').dataset.category;
            }

            // Clear search input when changing categories
            searchInput.value = '';
            renderContent(categoryKey);

            // Hide sidebar on mobile after selection
            if (window.innerWidth <= 768) {
                sidebar.classList.remove('active');
            }
        }

        // Function to handle search input
        let searchTimeout;
        searchInput.addEventListener('keyup', () => {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                const query = searchInput.value.trim();
                const activeCategory = document.querySelector('.category-item.active');
                if (activeCategory) {
                    renderContent(activeCategory.dataset.category, query);
                } else {
                    // If no category is active, default to the first one
                    showCategory(Object.keys(contentData)[0]);
                    renderContent(Object.keys(contentData)[0], query);
                }
            }, 300); // Debounce search input
        });

        // Add event listeners to category items
        categoryList.querySelectorAll('.category-item').forEach(item => {
            item.addEventListener('click', () => {
                showCategory(item.dataset.category);
            });
            // Make them clickable with Enter key as well
            item.addEventListener('keydown', (event) => {
                if (event.key === 'Enter' || event.keyCode === 13) {
                    showCategory(item.dataset.category);
                }
            });
        });

        // Mobile menu toggle
        mobileMenuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('active');
        });

        // Add copy functionality to code blocks
        function addCopyButtonListeners() {
            document.querySelectorAll('.code-block').forEach(block => {
                let copyButton = block.querySelector('.copy-button');
                if (!copyButton) { // Ensure button is only added once
                    copyButton = document.createElement('button');
                    copyButton.className = 'copy-button';
                    copyButton.textContent = 'Copy';
                    block.appendChild(copyButton);
                }

                copyButton.onclick = () => {
                    const code = block.querySelector('code').innerText;
                    navigator.clipboard.writeText(code).then(() => {
                        copyButton.textContent = 'Copied!';
                        setTimeout(() => {
                            copyButton.textContent = 'Copy';
                        }, 2000);
                    }).catch(err => {
                        console.error('Failed to copy text: ', err);
                    });
                };
            });
        }

        // Apply syntax highlighting to all code blocks after content is rendered
        function applyAllCodeBlockSyntaxHighlighting() {
            document.querySelectorAll('.code-block code').forEach(codeElement => {
                const parentBlock = codeElement.closest('.code-block');
                const lang = parentBlock ? parentBlock.dataset.lang : null;
                if (lang) {
                    const originalCode = codeElement.innerHTML; // Get raw HTML content
                    codeElement.innerHTML = applySyntaxHighlighting(originalCode, lang);
                }
            });
        }

        // Initial load: show SOC Operations by default
        document.addEventListener('DOMContentLoaded', () => {
            showCategory('soc');
        });

        // Keep sidebar active on larger screens if it was toggled off on mobile
        window.addEventListener('resize', () => {
            if (window.innerWidth > 768) {
                sidebar.classList.remove('active'); // Ensure sidebar is visible and not 'active' state on wider screens
            }
        });
    </script>
</body>
</html>